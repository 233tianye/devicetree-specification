<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Power.org(TM)">
<title>Standard for Embedded Power Architecture(TM) Platform Requirements (ePAPR)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="book">
<div id="header">
<h1>Standard for Embedded Power Architecture(TM) Platform Requirements (ePAPR)</h1>
<div class="details">
<span id="author" class="author">Power.org(TM)</span><br>
<span id="revnumber">version 1.1,</span>
<span id="revdate">08 April 2011</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<h2 id="_copyright" class="float">Copyright</h2>
<div class="paragraph">
<p>Copyright &#169; 2008,2011 Power.org. All rights reserved.</p>
</div>
<div class="paragraph">
<p>The Power Architecture and Power.org word marks and the Power and Power.org logos
and related marks are trademarks and service marks licensed by Power.org.
Implementation of certain elements of this document may require licenses under third
party intellectual property rights, including without limitation, patent rights. Power.org
and its Members are not, and shall not be held, responsible in any manner for identifying
or failing to identify any or all such third party intellectual property rights.</p>
</div>
<div class="paragraph">
<p>THIS POWER.ORG SPECIFICATION PROVIDED “AS IS” AND WITHOUT ANY WARRANTY OF
ANY KIND, INCLUDING, WITHOUT LIMITATION, ANY EXPRESS OR IMPLIED WARRANTY OF
NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
IN NO EVENT SHALL POWER.ORG OR ANY MEMBER OF POWER.ORG BE LIABLE FOR ANY
DIRECT, INDIRECT, SPECIAL, EXEMPLARY, PUNITIVE, OR CONSEQUENTIAL DAMAGES,
INCLUDING, WITHOUT LIMITATION, LOST PROFITS, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.</p>
</div>
<div class="paragraph">
<p>Questions pertaining to this document, or the terms or conditions of its
provision, should be addressed to:</p>
</div>
<div class="verseblock">
<pre class="content">IEEE-ISTO
445 Hoes Lane
Piscataway, NJ 08854
Attn: Power.org Board Secretary</pre>
</div>
<h2 id="_license_information" class="float">LICENSE INFORMATION</h2>
<div class="paragraph">
<p>&#169; Copyright 2008,2011 Power.org, Inc</p>
</div>
<div class="paragraph">
<p>&#169; Copyright Freescale Semiconductor, Inc., 2008,2011</p>
</div>
<div class="paragraph">
<p>&#169; Copyright International Business Machines Corporation, 2008,2011</p>
</div>
<div class="paragraph">
<p>All Rights Reserved.</p>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_purpose_and_scope">1.1. Purpose and Scope</a>
<ul class="sectlevel3">
<li><a href="#_organization_of_this_document">1.1.1. Organization of this Document</a></li>
</ul>
</li>
<li><a href="#_conventions_used_in_this_document">1.2. Conventions Used in this Document</a></li>
<li><a href="#_relationship_to_ieee_1275">1.3. Relationship to IEEE&#8482; 1275</a>
<ul class="sectlevel3">
<li><a href="#_32_bit_and_64_bit_support">1.3.1. 32-bit and 64-bit Support</a></li>
</ul>
</li>
<li><a href="#_references">1.4. References</a></li>
<li><a href="#_definition_of_terms">1.5. Definition of Terms</a></li>
</ul>
</li>
<li><a href="#_the_device_tree">2. The Device Tree</a>
<ul class="sectlevel2">
<li><a href="#_overview">2.1. Overview</a></li>
<li><a href="#_device_tree_structure_and_conventions">2.2. Device Tree Structure and Conventions</a>
<ul class="sectlevel3">
<li><a href="#_node_names">2.2.1. Node Names</a></li>
<li><a href="#_generic_names_recommendation">2.2.2. Generic Names Recommendation</a></li>
<li><a href="#_path_names">2.2.3. Path Names</a></li>
<li><a href="#_properties">2.2.4. Properties</a></li>
</ul>
</li>
<li><a href="#_standard_properties">2.3. Standard Properties</a>
<ul class="sectlevel3">
<li><a href="#_compatible">2.3.1. compatible</a></li>
<li><a href="#_model">2.3.2. model</a></li>
<li><a href="#_phandle">2.3.3. phandle</a></li>
<li><a href="#_status">2.3.4. status</a></li>
<li><a href="#__address_cells_and_size_cells">2.3.5. #address-cells and #size-cells</a></li>
<li><a href="#_reg">2.3.6. reg</a></li>
<li><a href="#_virtual_reg">2.3.7. virtual-reg</a></li>
<li><a href="#_ranges">2.3.8. ranges</a></li>
<li><a href="#_dma_ranges">2.3.9. dma-ranges</a></li>
<li><a href="#_name">2.3.10. name</a></li>
<li><a href="#_device_type">2.3.11. device_type</a></li>
</ul>
</li>
<li><a href="#_interrupts_and_interrupt_mapping">2.4. Interrupts and Interrupt Mapping</a>
<ul class="sectlevel3">
<li><a href="#_properties_for_interrupt_generating_devices">2.4.1. Properties for Interrupt Generating Devices</a></li>
<li><a href="#_properties_for_interrupt_controllers">2.4.2. Properties for Interrupt Controllers</a></li>
<li><a href="#_interrupt_nexus_properties">2.4.3. Interrupt Nexus Properties</a></li>
<li><a href="#_interrupt_mapping_example">2.4.4. Interrupt Mapping Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_device_node_requirements">3. Device Node Requirements</a>
<ul class="sectlevel2">
<li><a href="#_base_device_node_types">3.1. Base Device Node Types</a></li>
<li><a href="#_root_node">3.2. Root node</a></li>
<li><a href="#_aliases_node">3.3. aliases node</a></li>
<li><a href="#_memory_node">3.4. Memory node</a></li>
<li><a href="#_chosen">3.5. Chosen</a></li>
<li><a href="#_cpus_node_properties">3.6. CPUS Node Properties</a></li>
<li><a href="#_cpu_node_properties">3.7. CPU Node Properties</a>
<ul class="sectlevel3">
<li><a href="#_general_properties_of_cpu_nodes">3.7.1. General Properties of CPU nodes</a></li>
<li><a href="#_tlb_properties">3.7.2. TLB Properties</a></li>
<li><a href="#_internal_l1_cache_properties">3.7.3. Internal (L1) Cache Properties</a></li>
<li><a href="#_example">3.7.4. Example</a></li>
</ul>
</li>
<li><a href="#_multi_level_and_shared_caches">3.8. Multi-level and Shared Caches</a></li>
</ul>
</li>
<li><a href="#_client_program_image_format">4. Client Program Image Format</a>
<ul class="sectlevel2">
<li><a href="#_variable_address_image_format">4.1. Variable Address Image Format</a>
<ul class="sectlevel3">
<li><a href="#_elf_basics">4.1.1. ELF Basics</a></li>
<li><a href="#_boot_program_requirements">4.1.2. Boot Program Requirements</a></li>
<li><a href="#_client_program_requirements">4.1.3. Client Program Requirements</a></li>
</ul>
</li>
<li><a href="#_fixed_address_image_format">4.2. Fixed Address Image Format</a></li>
</ul>
</li>
<li><a href="#_client_program_boot_requirements">5. Client Program Boot Requirements</a>
<ul class="sectlevel2">
<li><a href="#_boot_and_secondary_cpus">5.1. Boot and Secondary CPUs</a></li>
<li><a href="#_device_tree">5.2. Device Tree</a></li>
<li><a href="#_initial_mapped_areas">5.3. Initial Mapped Areas</a></li>
<li><a href="#_cpu_entry_point_requirements">5.4. CPU Entry Point Requirements</a>
<ul class="sectlevel3">
<li><a href="#_boot_cpu_initial_register_state">5.4.1. Boot CPU Initial Register State</a></li>
<li><a href="#_i_o_devices_state">5.4.2. I/O Devices State</a></li>
<li><a href="#_initial_i_o_mappings_iio">5.4.3. Initial I/O Mappings (IIO)</a></li>
<li><a href="#_boot_cpu_entry_requirements_real_mode">5.4.4. Boot CPU Entry Requirements: Real Mode</a></li>
<li><a href="#_boot_cpu_entry_requirements_for_imas_book_iiii_e">5.4.5. Boot CPU Entry Requirements for IMAs: Book IIII-E</a></li>
</ul>
</li>
<li><a href="#_symmetric_multiprocessing_smp_boot_requirements">5.5. Symmetric Multiprocessing (SMP) Boot Requirements</a>
<ul class="sectlevel3">
<li><a href="#_overview_2">5.5.1. Overview</a></li>
<li><a href="#_spin_table">5.5.2. Spin Table</a></li>
<li><a href="#_implementation_specific_release_from_reset">5.5.3. Implementation-Specific Release from Reset</a></li>
<li><a href="#_timebase_synchronization">5.5.4. Timebase Synchronization</a></li>
</ul>
</li>
<li><a href="#_asymmetric_configuration_considerations">5.6. Asymmetric Configuration Considerations</a></li>
</ul>
</li>
<li><a href="#_device_bindings">6. Device Bindings</a>
<ul class="sectlevel2">
<li><a href="#_binding_guidelines">6.1. Binding Guidelines</a>
<ul class="sectlevel3">
<li><a href="#_general_principles">6.1.1. General Principles</a></li>
<li><a href="#_miscellaneous_properties">6.1.2. Miscellaneous Properties</a></li>
</ul>
</li>
<li><a href="#_serial_devices">6.2. Serial devices</a>
<ul class="sectlevel3">
<li><a href="#_serial_class_binding">6.2.1. Serial Class Binding</a></li>
<li><a href="#_national_semiconductor_16450_16550_compatible_uart_requirements">6.2.2. National Semiconductor 16450/16550 Compatible UART Requirements</a></li>
</ul>
</li>
<li><a href="#_network_devices">6.3. Network devices</a>
<ul class="sectlevel3">
<li><a href="#_network_class_binding">6.3.1. Network Class Binding</a></li>
<li><a href="#_ethernet_specific_considerations">6.3.2. Ethernet specific considerations</a></li>
</ul>
</li>
<li><a href="#_open_pic_interrupt_controllers">6.4. open PIC Interrupt Controllers</a></li>
<li><a href="#_simple_bus">6.5. simple-bus</a></li>
</ul>
</li>
<li><a href="#_flat_device_tree_physical_structure">7. Flat Device Tree Physical Structure</a>
<ul class="sectlevel2">
<li><a href="#_versioning">7.1. Versioning</a></li>
<li><a href="#_header">7.2. Header</a></li>
<li><a href="#_memory_reservation_block">7.3. Memory Reservation Block</a>
<ul class="sectlevel3">
<li><a href="#_purpose">7.3.1. Purpose</a></li>
<li><a href="#_format">7.3.2. Format</a></li>
</ul>
</li>
<li><a href="#_structure_block">7.4. Structure Block</a>
<ul class="sectlevel3">
<li><a href="#_lexical_structure">7.4.1. Lexical structure</a></li>
<li><a href="#_tree_structure">7.4.2. Tree structure</a></li>
</ul>
</li>
<li><a href="#_strings_block">7.5. Strings Block</a></li>
<li><a href="#_alignment">7.6. Alignment</a></li>
</ul>
</li>
<li><a href="#_appendix_a_device_tree_source_format_version_1">8. Appendix A Device Tree Source Format (version 1)</a>
<ul class="sectlevel2">
<li><a href="#_node_and_property_definitions">8.1. Node and property definitions</a></li>
<li><a href="#_file_layout">8.2. File layout</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="_acknowledgements" class="float">Acknowledgements</h2>
<div class="paragraph">
<p>The power.org Platform Architecture Technical Subcommittee would like
thank the many individuals and companies that contributed to the
development this specification through writing, technical discussions
and reviews.</p>
</div>
<div class="verseblock">
<div class="title">Individuals (in alphabetical order)</div>
<pre class="content">Hollis Blanchard
Dan Bouvier
Josh Boyer
Becky Bruce
Dale Farnsworth
Kumar Gala
David Gibson
Ben Herrenschmidt
Dan Hettena
Olof Johansson
Ashish Kalra
Grant Likely
Jon Loeliger
Hartmut Penner
Tim Radzykewycz
Heiko Schick
Timur Tabi
John Traill
John True
Matt Tyrlik
Dave Willoughby
Scott Wood
Jimi Xenidis
Stuart Yoder</pre>
</div>
<div class="verseblock">
<div class="title">Companies</div>
<pre class="content">Freescale Semiconductor
Green Hills Software
IBM
Montavista
Wind River</pre>
</div>
<h2 id="_other_acknowledgements" class="float">Other Acknowledgements</h2>
<div class="paragraph">
<p>Significant aspects of the ePAPR device tree are based on work done by
the Open Firmware Working Group which developed bindings for IEEE-1275.
We would like to acknowledge their contributions.</p>
</div>
<div class="paragraph">
<p>We would also like to acknowledge the contribution of the PowerPC Linux
community that initially developed and implemented the flattened device
tree concept.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Revision History</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 15%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Revision</th>
<th class="tableblock halign-left valign-top">Date</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7/23/2008</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial Version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3/7/2011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates include: virtualization chapter, consolidated representation of
cpu nodes, stdin/stdout properties on /chosen, label property,
representation of hardware threads on cpu nodes, representation of Power
ISA categories on cpu nodes, mmu type property, removal of some
bindings, additional cpu entry requirements for threaded cpus,
miscellaneous cleanup and clarifications.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose_and_scope">1.1. Purpose and Scope</h3>
<div class="paragraph">
<p>To initialize and boot a computer system, various software components
interact—firmware might perform low-level initialization of the system
hardware before passing control to software such as an operating system,
bootloader, or hypervisor. Bootloaders and hypervisors can, in turn,
load and transfer control to operating systems. Standard, consistent
interfaces and conventions facilitate the interactions between these
software components. In this document the term boot program is used to
generically refer to a software component that initializes the system
state and executes another software component referred to as a client
program. Examples of a boot programs include: firmware, bootloaders, and
hypervisors. Examples of a client program include: bootloaders,
hypervisors, operating systems, and special purpose programs. A piece of
software (e.g. a hypervisor) may be both a client program and a boot
program.</p>
</div>
<div class="paragraph">
<p>This specification, the Embedded Power Architecture&#8482; Platform Requirements (ePAPR), provides a complete boot
program to client program interface definition, combined with minimum system
requirements that facilitate the development of a wide variety of embedded
systems based on CPUs that implement the Power architecture as defined in the
Power ISA&#8482;<a href="#b1">[b1]</a>.</p>
</div>
<div class="paragraph">
<p>This specification is targeted towards the requirements of embedded
systems. An embedded system typically consists of system hardware, an
operating system, and application software that are custom designed to
perform a fixed, specific set of tasks. This is unlike general purpose
computers, which are designed to be customized by a user with a variety
of software and I/O devices. Other characteristics of embedded systems
can include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a fixed set of I/O devices, possibly highly customized for the
application</p>
</li>
<li>
<p>a system board optimized for size and cost</p>
</li>
<li>
<p>limited user interface</p>
</li>
<li>
<p>resource constraints like limited memory and limited nonvolatile storage</p>
</li>
<li>
<p>real-time constraints</p>
</li>
<li>
<p>use of a wide variety of operating systems, including Linux, real-time
operating systems, and custom or proprietary operating systems</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_organization_of_this_document">1.1.1. Organization of this Document</h4>
<div class="paragraph">
<p>Chapter 1 introduces the architecture being specified by the ePAPR.</p>
</div>
<div class="paragraph">
<p>Chapter 2 introduces the device tree concept and describes its logical
structure and standard properties.</p>
</div>
<div class="paragraph">
<p>Chapter 3 specifies the definition of a base set of device nodes
required by ePAPR-compliant device trees.</p>
</div>
<div class="paragraph">
<p>Chapter 4 specifies the ELF client program image format.</p>
</div>
<div class="paragraph">
<p>Chapter 5 specifies the requirements for boot programs to start client
programs on single and multiple CPU systems.</p>
</div>
<div class="paragraph">
<p>Chapter 6 describes device bindings for certain classes of devices and
specific device types.</p>
</div>
<div class="paragraph">
<p>Chapter 7 describes ePAPR virtualization extensions-- hypercall ABI,
hypercall APIs, and device tree conventions related to virtualization.</p>
</div>
<div class="paragraph">
<p>Chapter 8 specifies the physical structure of device trees.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conventions_used_in_this_document">1.2. Conventions Used in this Document</h3>
<div class="paragraph">
<p>The word <em>shall</em> is used to indicate mandatory requirements strictly to
be followed in order to conform to the standard and from which no
deviation is permitted (<em>shall</em> equals <em>is required to</em>).</p>
</div>
<div class="paragraph">
<p>The word <em>should</em> is used to indicate that among several possibilities
one is recommended as particularly suitable, without mentioning or
excluding others; or that a certain course of action is preferred but
not necessarily required; or that (in the negative form) a certain
course of action is deprecated but not prohibited (<em>should</em> equals <em>is
recommended that</em>).</p>
</div>
<div class="paragraph">
<p>The word <em>may</em> is used to indicate a course of action permissible within
the limits of the standard (<em>may</em> equals <em>is permitted</em>).</p>
</div>
<div class="paragraph">
<p>Examples of device tree constructs are frequently shown in <em>Device Tree
Syntax</em> form. See <em>Appendix A Device Tree Source Format (version 1)</em> for
an overview of this syntax.</p>
</div>
</div>
<div class="sect2">
<h3 id="_relationship_to_ieee_1275">1.3. Relationship to IEEE&#8482; 1275</h3>
<div class="paragraph">
<p>The ePAPR is loosely related to the IEEE 1275 Open Firmware
standard—<em>IEEE Standard for Boot (Initialization Configuration)
Firmware: Core Requirements and Practices</em> <a href="#b1">[b1]</a>.</p>
</div>
<div class="paragraph">
<p>The original IEEE 1275 specification and its derivatives such as CHRP
<a href="#b10">[b10]</a> and PAPR <a href="#b16">[b16]</a> address problems of general purpose
computers, such as how a single version of an operating system can work
on several different computers within the same family and the problem of
loading an operating system from user-installed I/O devices.</p>
</div>
<div class="paragraph">
<p>Because of the nature of embedded systems, some of these problems faced
by open, general purpose computers do not apply. Notable features of the
IEEE 1275 specification that are omitted from the ePAPR include:
* Plug-in device drivers
* FCode
* The programmable Open Firmware user interface based on Forth
* FCode debugging
* Operating system debugging</p>
</div>
<div class="paragraph">
<p>What <em>is</em> retained from IEEE-1275 are concepts from the device tree
architecture by which a boot program can describe and communicate system
hardware information to client program, thus eliminating the need for
the client program to have hard-coded descriptions of system hardware.</p>
</div>
<div class="sect3">
<h4 id="_32_bit_and_64_bit_support">1.3.1. 32-bit and 64-bit Support</h4>
<div class="paragraph">
<p>The ePAPR supports CPUs with both 32-bit and 64-bit addressing
capabilities. Where applicable, sections of the ePAPR describe any
requirements or considerations for 32-bit and 64-bit addressing.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_references">1.4. References</h3>
<div class="ulist">
<ul>
<li>
<p><a id="b1"></a>[b1] <em>Power ISA&#8482;</em>, Version 2.06 Revision B, July 23, 2010. It is
available from power.org (<a href="http://power.org" class="bare">http://power.org</a>)</p>
</li>
<li>
<p><a id="b2"></a>[b2] <em>Boot (Initialization Configuration) Firmware: Core
Requirements and Practices</em>, 1994, This is the core standard (also
known as IEEE 1275) that defines the device tree concept adopted by
the ePAPR. It is available from Global Engineering (<a href="http://global.ihs.com/" class="bare">http://global.ihs.com/</a>).</p>
</li>
<li>
<p><a id="b3"></a>[b3] <em>PowerPC Processor Binding to IEEE 1275-1994 Standard for Boot
(Initialization, Configuration) Firmware</em>, Version 2.1, Open Firmware
Working Group, (<a href="http://playground.sun.com/1275/bindings/ppc/release/ppc-2_1.html" class="bare">http://playground.sun.com/1275/bindings/ppc/release/ppc-2_1.html</a>),
1996, This document specifies the PowerPC processor specific binding
to the base standard.</p>
</li>
<li>
<p><a id="b4"></a>[b4] <em>booting-without-of.txt</em>, Ben Herrenschmidt, Becky Bruce, et al.,
From the Linux kernel source tree
(<a href="http://www.kernel.org/" class="bare">http://www.kernel.org/</a>), Describes the device tree as used by the Linux kernel.</p>
</li>
<li>
<p><a id="b5"></a>[b5] <em>Device Trees Everywhere</em>, David Gibson and Ben Herrenschmidt
(<a href="http://ozlabs.org/~dgibson/home/papers/dtc-paper.pdf" class="bare">http://ozlabs.org/~dgibson/home/papers/dtc-paper.pdf</a>),
An overview of the concept of the device tree and device tree compiler.</p>
</li>
<li>
<p><a id="b6"></a>[b6] <em>PCI Bus Binding to: IEEE Std 1275-1994 Standard for Boot
(Initialization Configuration) Firmware</em>, Revision 2.1,
Open Firmware Working Group, 1998
(<a href="http://playground.sun.com/1275/bindings/pci/pci2_1.pdf" class="bare">http://playground.sun.com/1275/bindings/pci/pci2_1.pdf</a>)</p>
</li>
<li>
<p><a id="b7"></a>[b7] <em>Open Firmware Recommended Practice: Interrupt Mapping</em>, Version 0.9,
Open Firmware Working Group, 1996
(<a href="http://playground.sun.com/1275/practice/imap/imap0_9d.pdf" class="bare">http://playground.sun.com/1275/practice/imap/imap0_9d.pdf</a>)</p>
</li>
<li>
<p><a id="b8"></a>[b8] <em>Open Firmware Recommended Practice: Device Support Extensions</em>, Version 1.0,
Open Firmware Working Group, 1997,
(<a href="http://playground.sun.com/1275/practice/devicex/dse1_0a.html" class="bare">http://playground.sun.com/1275/practice/devicex/dse1_0a.html</a>)
This document describes the binding for various device types such as
network, RTC, keyboard, sound, etc.</p>
</li>
<li>
<p><a id="b9"></a>[b9] <em>Open Firmware Recommended Practice: Universal Serial Bus
Binding to IEEE 1275</em>, Version 1,
Open Firmware Working Group, 1998
(<a href="http://playground.sun.com/1275/bindings/usb/usb-1_0.ps" class="bare">http://playground.sun.com/1275/bindings/usb/usb-1_0.ps</a>)</p>
</li>
<li>
<p><a id="b10"></a>[b10] <em>PowerPC Microprocessor Common Hardware Reference Platform (CHRP)
Binding</em>, Version 1.8,
Open Firmware Working Group, 1998
(<a href="http://playground.sun.com/1275/bindings/chrp/chrp1_8a.ps" class="bare">http://playground.sun.com/1275/bindings/chrp/chrp1_8a.ps</a>).
This document specifies the properties for Open PIC-compatible
interrupt controllers.</p>
</li>
<li>
<p><a id="b11"></a>[b11] <em>CHRP ISA Interrupt Controller Device Binding</em>,
Unapproved Draft version 1.1,
Open Firmware Working Group, Aug 19, 1996
(<a href="http://playground.sun.com/1275/bindings/devices/postscript/isa-pic-1_1d.ps" class="bare">http://playground.sun.com/1275/bindings/devices/postscript/isa-pic-1_1d.ps</a>)</p>
</li>
<li>
<p><a id="b12"></a>[b12] <em>The Open Programmable Interrupt Controller (PIC) Register
Interface Specification</em>, Revision 1.2,
Advanced Micro Devices and Cyrix Corporation, October 1995</p>
</li>
<li>
<p><a id="b13"></a>[b13] <em>PCI Local Bus Specification</em>, Revision 2.2, PCI Special Interest Group</p>
</li>
<li>
<p><a id="b14"></a>[b14] <em>PCI Express Base Specification</em>, Revision 1.0a, PCI Special Interest Group</p>
</li>
<li>
<p><a id="b15"></a>[b15] <em>PCI-Express Binding to OF</em>, P1275 Openboot Working Group Proposal, 18 August 2004</p>
</li>
<li>
<p><a id="b16"></a>[b16] <em>Power.org Standard for Power Architecture Platform Requirements</em>, power.org</p>
</li>
<li>
<p><a id="b17"></a>[b17] <em>System V Application Binary Interface, Edition 4.1</em>,
Published by The Santa Cruz Operation, Inc., 1997</p>
</li>
<li>
<p><a id="b18"></a>[b18] <em>The Open Programmable Interrupt Controller (PIC) Register
Interface Specification Revision 1.2</em>, AMD and Cyrix, October 1995</p>
</li>
<li>
<p><a id="b19"></a>[b19] <em>RFC 2119, Key words for use in RFCs to Indicate Requirement
Levels</em>, <a href="http://www.ietf.org/rfc/rfc2119.txt" class="bare">http://www.ietf.org/rfc/rfc2119.txt</a></p>
</li>
<li>
<p><a id="b20"></a>[b20] <em>64-bit PowerPC ELF Application Binary Interface Supplement
1.9</em>, Ian Lance Taylor, 2004</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_definition_of_terms">1.5. Definition of Terms</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">AMP</dt>
<dd>
<p>Asymmetric Multiprocessing. Computer architecture where two or
more CPUs are executing different tasks. Typically, an AMP system
executes different operating system images on separate CPUs.</p>
</dd>
<dt class="hdlist1">boot CPU</dt>
<dd>
<p>The first CPU which a boot program directs to a client program&#8217;s entry point.</p>
</dd>
<dt class="hdlist1">Book III-E</dt>
<dd>
<p>Embedded Environment. Section of the Power ISA defining
supervisor instructions and related facilities used in embedded Power
processor implementations.</p>
</dd>
<dt class="hdlist1">boot program</dt>
<dd>
<p>Used to generically refer to a software component that
initializes the system state and executes another software component
referred to as a client program. Examples of a boot programs include:
firmware, bootloaders, and hypervisors.</p>
</dd>
<dt class="hdlist1">client program</dt>
<dd>
<p>Program that typically contains application or
operating system software. Examples of a client program include:
bootloaders, hypervisors, operating systems, and special purpose
programs.</p>
</dd>
<dt class="hdlist1">cell</dt>
<dd>
<p>A unit of information consisting of 32 bits.</p>
</dd>
<dt class="hdlist1">DMA</dt>
<dd>
<p>Direct memory access</p>
</dd>
<dt class="hdlist1">DTB</dt>
<dd>
<p>Device tree blob. Compact binary representation of the device tree.</p>
</dd>
<dt class="hdlist1">DTC</dt>
<dd>
<p>Device tree compiler. An open source tool used to create DTB files from DTS files.</p>
</dd>
<dt class="hdlist1">DTS</dt>
<dd>
<p>Device tree syntax. A textual representation of a device tree consumed by the DTC.
See Appendix A Device Tree Source Format (version 1).</p>
</dd>
<dt class="hdlist1">effective address</dt>
<dd>
<p>Memory address as computed by processor storage
access or branch instruction.</p>
</dd>
<dt class="hdlist1">physical address</dt>
<dd>
<p>Address used by the processor to access external
device, typically a memory controller. The Power ISA uses the <em>real
address</em> when referring to a physical address.</p>
</dd>
<dt class="hdlist1">Power ISA</dt>
<dd>
<p>Power Instruction Set Architecture.</p>
</dd>
<dt class="hdlist1">interrupt specifier</dt>
<dd>
<p>A property value that describes an interrupt.
Typically information that specifies an interrupt number and sensitivity
and triggering mechanism is included.</p>
</dd>
<dt class="hdlist1">secondary CPU</dt>
<dd>
<p>CPUs other than the boot CPU that belong to the client
program are considered <em>secondary CPUs</em>.</p>
</dd>
<dt class="hdlist1">SMP</dt>
<dd>
<p>Symmetric multiprocessing. A computer architecture where two or
more identical CPUs can execute the same task. Typically an SMP system
executes a single operating system image.</p>
</dd>
<dt class="hdlist1">SoC</dt>
<dd>
<p>System on a chip. A single computer chip integrating one or more
CPU core as well as number of other peripherals.</p>
</dd>
<dt class="hdlist1">unit address</dt>
<dd>
<p>The part of a node name specifying the node&#8217;s address in
the address space of the parent node.</p>
</dd>
<dt class="hdlist1">quiescent CPU</dt>
<dd>
<p>A quiescent CPU is in a state where it cannot interfere
with the normal operation of other CPUs, nor can its state be affected
by the normal operation of other running CPUs, except by an explicit
method for enabling or re-enabling the quiescent CPU.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_device_tree">2. The Device Tree</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview">2.1. Overview</h3>
<div class="paragraph">
<p>The ePAPR specifies a construct called a <em>device tree</em> to describe
system hardware. A boot program loads a device tree into a client
program&#8217;s memory and passes a pointer to the device tree to the client.</p>
</div>
<div class="paragraph">
<p>This chapter describes the logical structure of the device tree and
specifies a base set of properties for use in describing device nodes.
Chapter 3 specifies certain device nodes required by an ePAPRcompliant
device tree. Chapter 6 describes the ePAPR defined device bindings— the
requirements for representing certain device types classes of devices.
Chapter 8 describes the in-memory encoding of the device tree.</p>
</div>
<div class="paragraph">
<p>A device tree is a tree data structure with nodes that describe the
devices in a system. Each node has property/value pairs that describe
the characteristics of the device being represented. Each node has
exactly one parent except for the root node, which has no parent.</p>
</div>
<div class="paragraph">
<p>An ePAPR-compliant device tree describes device information in a system
that cannot necessarily be dynamically detected by a client program. For
example, the architecture of PCI enables a client to probe and detect
attached devices, and thus device tree nodes describing PCI devices
might not be required. However, a device node is required to describe a
PCI host bridge device in the system if it cannot be detected by
probing.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p><a href="#device-tree-example">Device Tree Logical Structure</a> shows an example representation of a simple device tree that
is nearly complete enough to boot a simple operating system, with the
platform type, CPU, and memory described. Device nodes are shown with
properties and values shown beside the node.</p>
</div>
<div id="device-tree-example" class="imageblock">
<div class="content">
<img src="./images/diag-e2a712d2228afde62596375277d681df.png" alt="Device Tree Logical Structure" width="432" height="134">
</div>
<div class="title">Figure 1. Device Tree Logical Structure</div>
</div>
</div>
<div class="sect2">
<h3 id="_device_tree_structure_and_conventions">2.2. Device Tree Structure and Conventions</h3>
<div class="sect3">
<h4 id="_node_names">2.2.1. Node Names</h4>
<div class="sect4">
<h5 id="_node_name_requirements">Node Name Requirements</h5>
<div class="paragraph">
<p>Each node in the device tree is named according to the following convention:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>node-name@unit-address</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>node-name</em> component specifies the name of the node. It shall be 1
to 31 characters in length and consist solely of characters from the set
of characters in <a href="#node-name-characters">Characters for node names</a></p>
</div>
<table id="node-name-characters" class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Characters for node names</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Character</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0-9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">digit</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">a-z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lowercase letter</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">A-Z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uppercase letter</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">,</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comma</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">period</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">_</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">underscore</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">plus sign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dash</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <em>node-name</em> shall start with a lower or uppercase character and should
describe the general class of device.</p>
</div>
<div class="paragraph">
<p>The <em>unit-address</em> component of the name is specific to the bus type on
which the node sits. It consists of one or more ASCII characters from
the set of characters in <a href="#node-name-characters">Characters for node names</a>. The unit-address must match the
first address specified in the <em>reg</em> property of the node. If the node
has no <em>reg</em> property, the @ and <em>unit-address</em> must be omitted and the
<em>node-name</em> alone differentiates the node from other nodes at the same
level in the tree. The binding for a particular bus may specify
additional, more specific requirements for the format of <em>reg</em> and the
<em>unit-address</em>.</p>
</div>
<div class="paragraph">
<p>The root node does not have a node-name or unit-address. It is
identified by a forward slash (/).</p>
</div>
<div id="example-node-names" class="imageblock">
<div class="content">
<img src="./images/diag-9f13852998466b838915177b2a098598.png" alt="Examples of Node Names" width="432" height="127">
</div>
<div class="title">Figure 2. Examples of Node Names</div>
</div>
<div class="paragraph">
<p>In <a href="#example-node-names">Examples of Node Names</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The nodes with the name cpu are distinguished by their unit-address
values of 0 and 1.</p>
</li>
<li>
<p>The nodes with the name Ethernet are distinguished by their
unit-address values of FE001000 and FE002000.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_generic_names_recommendation">2.2.2. Generic Names Recommendation</h4>
<div class="paragraph">
<p>The name of a node should be somewhat generic, reflecting the function of the device and not its
precise programming model. If appropriate, the name should be one of the following choices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>atm</p>
</li>
<li>
<p>cache-controller</p>
</li>
<li>
<p>compact-flash</p>
</li>
<li>
<p>can</p>
</li>
<li>
<p>cpu</p>
</li>
<li>
<p>crypto</p>
</li>
<li>
<p>disk</p>
</li>
<li>
<p>display</p>
</li>
<li>
<p>dma-controller</p>
</li>
<li>
<p>ethernet</p>
</li>
<li>
<p>ethernet-phy</p>
</li>
<li>
<p>fdc</p>
</li>
<li>
<p>flash</p>
</li>
<li>
<p>gpio</p>
</li>
<li>
<p>i2c</p>
</li>
<li>
<p>ide</p>
</li>
<li>
<p>interrupt-controller</p>
</li>
<li>
<p>isa</p>
</li>
<li>
<p>keyboard</p>
</li>
<li>
<p>mdio</p>
</li>
<li>
<p>memory</p>
</li>
<li>
<p>memory-controller</p>
</li>
<li>
<p>mouse</p>
</li>
<li>
<p>nvram</p>
</li>
<li>
<p>parallel</p>
</li>
<li>
<p>pc-card</p>
</li>
<li>
<p>pci</p>
</li>
<li>
<p>pcie</p>
</li>
<li>
<p>rtc</p>
</li>
<li>
<p>sata</p>
</li>
<li>
<p>scsi</p>
</li>
<li>
<p>serial</p>
</li>
<li>
<p>sound</p>
</li>
<li>
<p>spi</p>
</li>
<li>
<p>timer</p>
</li>
<li>
<p>usb</p>
</li>
<li>
<p>vme</p>
</li>
<li>
<p>watchdog</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_path_names">2.2.3. Path Names</h4>
<div class="paragraph">
<p>A node in the device tree can be uniquely identified by specifying the
full path from the root node, through all descendant nodes, to the
desired node.</p>
</div>
<div class="paragraph">
<p>The convention for specifying a device path is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/node-name-1/node-name-2/node-name-N</pre>
</div>
</div>
<div class="paragraph">
<p>For example, in <a href="#example-node-names">Examples of Node Names</a>, the device path to cpu #1 would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/cpus/cpu@1</pre>
</div>
</div>
<div class="paragraph">
<p>The path to the root node is /.</p>
</div>
<div class="paragraph">
<p>A unit address may be omitted if the full path to the node is unambiguous.</p>
</div>
<div class="paragraph">
<p>If a client program encounters an ambiguous path, its behavior is undefined.</p>
</div>
</div>
<div class="sect3">
<h4 id="_properties">2.2.4. Properties</h4>
<div class="paragraph">
<p>Each node in the device tree has properties that describe the
characteristics of the node. Properties consist of a name and a value.</p>
</div>
<div class="sect4">
<h5 id="_property_names">Property Names</h5>
<div class="paragraph">
<p>Property names are strings of 1 to 31 characters from the following set
of characters.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Characters for property names</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Character</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0-9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">digit</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">a-z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lowercase letter</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">A-Z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uppercase letter</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">,</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comma</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">period</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">_</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">underscore</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">plus sign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">question mark</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">#</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hash</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Nonstandard property names should specify a unique string prefix, such
as a stock ticker symbol, identifying the name of the company or
organization that defined the property. Examples: fsl,channel-fifo-len
ibm,ppc-interrupt-server#s linux,network-index</p>
</div>
</div>
<div class="sect4">
<h5 id="_property_values">Property Values</h5>
<div class="paragraph">
<p>A property value is an array of zero or more bytes that contain
information associated with the property.</p>
</div>
<div class="paragraph">
<p>Properties might have an empty value if conveying true-false
information. In this case, the presence or absence of the property is
sufficiently descriptive.</p>
</div>
<div class="paragraph">
<p><a href="#property-values-table">Property values</a> describes the set of basic value types defined by the ePAPR.</p>
</div>
<table id="property-values-table" class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Property values</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;empty&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is empty—used for conveying true-false
information, when the presence of absence of the property itself is
sufficiently descriptive.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A 32-bit integer in big-endian format. Example: the 32-bit
value 0x11223344 would be represented in memory as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  address  11
address+1  22
address+2  33
address+3  44</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u64&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Represents a 64-bit integer in big-endian format. Consists of
two &lt;u32&gt; values where the first value contains the most significant
bits of the integer and the second value contains the least significant
bits.</p>
</div>
<div class="paragraph">
<p>Example: the 64-bit value 0x1122334455667788 would be represented as two
cells as: &lt;0x11223344 0x55667788&gt;.</p>
</div>
<div class="paragraph">
<p>The value would be represented in memory as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  address  11
address+1  22
address+2  33
address+3  44
address+4  55
address+5  66
address+6  77
address+7  88</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Strings are printable and null-terminated. Example: the
string “hello” would be represented in memory as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  address  68  'h'
address+1  65  'e'
address+2  6C  'l'
address+3  6C  'l'
address+4  6F  'o'
address+5  00  '\0'</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;prop-encoded-array&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format is specific to the property. See the
property definition.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;phandle&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A &lt;u32&gt; value. A <em>phandle</em> value is a way to reference
another node in the device tree. Any node that can be referenced defines
a phandle property with a unique &lt;u32&gt; value. That unique number is
specified for the value of properties with a phandle value type.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;stringlist&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A list of &lt;string&gt; values concatenated together.</p>
</div>
<div class="paragraph">
<p>Example: The string list “hello”,“world” would be represented in memory as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   address  68  'h'
 address+1  65  'e'
 address+2  6C  'l'
 address+3  6C  'l'
 address+4  6F  'o'
 address+5  00  '\0'
 address+6  77  'w'
 address+7  6f  'o'
 address+8  72  'r'
 address+9  6C  'l'
address+10  64  'd'
address+11  00  '\0'</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_standard_properties">2.3. Standard Properties</h3>
<div class="paragraph">
<p>The ePAPR specifies a set of standard properties for device nodes. These
properties are described in detail in this section. Device nodes defined
by the ePAPR (see Chapter 3, Device Node Requirements) may specify
additional requirements or constraints regarding the use of the standard
properties. Device bindings (Chapter 6) that describe the representation
of specific devices may also specify additional requirements.</p>
</div>
<div class="paragraph">
<p>Note: All examples of device tree nodes in this document use the Device
Tree Source (DTS) format for specifying nodes and properties.</p>
</div>
<div class="sect3">
<h4 id="_compatible">2.3.1. compatible</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>compatible</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;stringlist&gt;</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>compatible</em> property value consists of one or more strings that
define the specific programming model for the device. This list of
strings should be used by a client program for device driver selection.
The property value consists of a concatenated list of null terminated
strings, from most specific to most general. They allow a device to
express its compatibility with a family of similar devices, potentially
allowing a single device driver to match against several devices.</p>
</div>
<div class="paragraph">
<p>The recommended format is <code>“manufacturer,model”</code>, where <code>manufacturer</code> is a
string describing the name of the manufacturer (such as a stock ticker
symbol), and <code>model</code> specifies the model number.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>compatible = “fsl,mpc8641-uart”, “ns16550";</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, an operating system would first try to locate a device
driver that supported fsl,mpc8641-uart. If a driver was not found, it
would then try to locate a driver that supported the more general
ns16550 device type.</p>
</div>
</div>
<div class="sect3">
<h4 id="_model">2.3.2. model</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>model</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;stringlist&gt;</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The model property value is a &lt;string&gt; that specifies the manufacturer&#8217;s
model number of the device.</p>
</div>
<div class="paragraph">
<p>The recommended format is: <code>“manufacturer,model”</code>, where <code>manufacturer</code> is a
string describing the name of the manufacturer (such as a stock ticker
symbol), and model specifies the model number.
.Example</p>
</div>
<div class="listingblock">
<div class="content">
<pre>model = “fsl,MPC8349EMITX”;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_phandle">2.3.3. phandle</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>phandle</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;u32&gt;</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>phandle</em> property specifies a numerical identifier for a node that is
unique within the device tree. The <em>phandle</em> property value is used by
other nodes that need to refer to the node associated with the property.
.Example
See the following device tree excerpt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>pic@10000000 {
	phandle = &lt;1&gt;;
	interrupt-controller;
};</pre>
</div>
</div>
<div class="paragraph">
<p>A <em>phandle</em> value of 1 is defined. Another device node could reference the
pic node with a phandle value of 1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>interrupt-parent = &lt;1&gt;;</pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Compatibility Note</div>
<div class="paragraph">
<p>Older versions of device trees may be encountered that contain a
deprecated form of this property called <code>linux,phandle</code>. For
compatibility, a client program might want to support <code>linux,phandle</code> if
a <code>phandle</code> property is not present. The meaning and use of the two
properties is identical.</p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Note</div>
<div class="paragraph">
<p>Most device trees in Device Tree Syntax (DTS) (see Appendix A) will not
contain explicit phandle properties. The DTC tool automatically inserts
the <code>phandle</code> properties when the DTS is compiled into the binary DTB
format.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_status">2.3.4. status</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>status</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;string&gt;</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>status</em> property indicates the operational status of a device. Valid
values are listed and defined in the following table.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. Values for status property</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">“okay”</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the device is operational</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">“disabled”</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the device is not presently operational, but
it might become operational in the future (for example, something is not
plugged in, or switched off).
</p><p class="tableblock">Refer to the device binding for details on what disabled means for a
given device.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">“fail”</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the device is not operational. A serious error
was detected in the device, and it is unlikely to become operational
without repair.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">“fail-sss”</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the device is not operational. A serious
error was detected in the device and it is unlikely to become
operational without repair. The sss portion of the value is specific to
the device and indicates the error condition detected.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="__address_cells_and_size_cells">2.3.5. #address-cells and #size-cells</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>#address-cells</em>, <em>#size-cells</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;u32&gt;</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>#address-cells</em> and <em>#size-cells</em> properties may be used in any device
node that has children in the device tree hierarchy and describes how
child device nodes should be addressed. The <em>#address-cells</em> property
defines the number of &lt;u32&gt; cells used to encode the address field in a
child node&#8217;s <em>reg</em> property. The <em>#size-cells</em> property defines the number
of &lt;u32&gt; cells used to encode the size field in a child node&#8217;s <em>reg</em>
property.</p>
</div>
<div class="paragraph">
<p>The <em>#address-cells</em> and <em>#size-cells</em> properties are not inherited from
ancestors in the device tree. They shall be explicitly defined.</p>
</div>
<div class="paragraph">
<p>An ePAPR-compliant boot program shall supply <em>#address-cells</em> and
<em>#size-cells</em> on all nodes that have children.</p>
</div>
<div class="paragraph">
<p>If missing, a client program should assume a default value of 2 for
<em>#address-cells</em>, and a value of 1 for <em>#size-cells</em>.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>See the device tree fragment shown in <a href="#address-size-cells-example">Specifying number of address and size cells</a>.</p>
</div>
<div id="address-size-cells-example" class="listingblock">
<div class="title">Specifying number of address and size cells</div>
<div class="content">
<pre>FIXME
soc

#address-cells = &lt;1&gt;;
#size-cells = &lt;1&gt;;

serial


compatible = "ns16550";
reg = &lt;0x4600 0x100&gt;;
clock-frequency = &lt;0&gt;;
interrupts = &lt;0xA 0x8&gt;;
interrupt-parent = &lt; &amp;ipic &gt;;</pre>
</div>
</div>
<div class="paragraph">
<p>In <a href="#address-size-cells-example">Specifying number of address and size cells</a>, the <em>#address-cells</em> and <em>#size-cells</em> properties of the soc
node are both set to 1. This setting specifies that one cell is required
to represent an address and one cell is required to represent the size
of nodes that are children of this node.</p>
</div>
<div class="paragraph">
<p>The serial device <em>reg</em> property necessarily follows this specification
set in the parent (soc) node—the address is represented by a single cell
(0x4600), and the size is represented by a single cell (0x100).</p>
</div>
</div>
<div class="sect3">
<h4 id="_reg">2.3.6. reg</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>reg</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;prop-encoded-array&gt;</em> encoded as arbitrary number of (address,length) pairs.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>reg</em> property describes the address of the device&#8217;s resources within
the address space defined by its parent bus. Most commonly this means
the offsets and lengths of memory-mapped IO register blocks, but may
have a different meaning on some bus types. Addresses in the address
space defined by root node are cpu real addresses.</p>
</div>
<div class="paragraph">
<p>The value is a <em>&lt;prop-encoded-array&gt;</em>, composed of an arbitrary number of
pairs of address and length, <em>&lt;address length&gt;</em>. The number of <em>&lt;u32&gt;</em> cells
required to specify the address and length are bus-specific and are
specified by the <em>#address-cells</em> and <em>#size-cells</em> properties in the parent
of the device node. If the parent node specifies a value of 0 for
<em>#size-cells</em>, the length field in the value of <em>reg</em> shall be omitted.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>Suppose a device within a system-on-a-chip had two blocks of
registers—a 32-byte block at offset 0x3000 in the SOC and a 256-byte
block at offset 0xFE00. The <em>reg</em> property would be encoded as follows
(assuming <em>#address-cells</em> and <em>#size-cells</em> values of 1):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>reg = &lt;0x3000 0x20 0xFE00 0x100&gt;;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_virtual_reg">2.3.7. virtual-reg</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>virtual-reg</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;u32&gt;</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>virtual-reg</em> property specifies an effective address that maps to the
first physical address specified in the <em>reg</em> property of the device node.
This property enables boot programs to provide client programs with
virtual-to-physical mappings that have been set up.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ranges">2.3.8. ranges</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>ranges</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;empty&gt;</em> or <em>&lt;prop-encoded-array&gt;</em> encoded as arbitrary number
of triplets of (<em>child-bus-address</em>, <em>parent-bus-address</em>, <em>length</em>).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>ranges</em> property provides a means of defining a mapping or
translation between the address space of the bus (the child address
space) and the address space of the bus node&#8217;s parent (the parent
address space).</p>
</div>
<div class="paragraph">
<p>The format of the value of the <em>ranges</em> property is an arbitrary number of
triplets of (<em>child-bus-address</em>, <em>parent-bus-address</em>, <em>length</em>)
* The <em>child-bus-address</em> is a physical address within the child bus'
  address space. The number of cells to represent the address is bus
  dependent and can be determined from the <em>#address-cells</em> of this node
  (the node in which the <em>ranges</em> property appears).
* The <em>parent-bus-address</em> is a physical address within the parent bus'
  address space. The number of cells to represent the parent address is
  bus dependent and can be determined from the <em>#address-cells</em> property
  of the node that defines the parent&#8217;s address space.
* The <em>length</em> specifies the size of the range in the child&#8217;s address
  space. The number of cells to represent the size can be determined
  from the <em>#size-cells</em> of this node (the node in which the <em>ranges</em>
  property appears).</p>
</div>
<div class="paragraph">
<p>If the property is defined with an &lt;empty&gt; value, it specifies that the
parent and child address space is identical, and no address translation
is required.</p>
</div>
<div class="paragraph">
<p>If the property is not present in a bus node, it is assumed that no
mapping exists between children of the node and the parent address
space.</p>
</div>
<div id="address-translation-example" class="listingblock">
<div class="title">Address Translation Example</div>
<div class="content">
<pre>FIXME
soc

compatible = "simple-bus";
#address-cells = &lt;1&gt;;
_#size-cells_ = &lt;1&gt;;
ranges = &lt;0x0 0xe0000000 0x00100000&gt;;

serial

device_type = "serial";
compatible = "ns16550";
reg = &lt;0x4600 0x100&gt;;
clock-frequency = &lt;0&gt;;
interrupts = &lt;0xA 0x8&gt;;
interrupt-parent = &lt; &amp;ipic &gt;;</pre>
</div>
</div>
<div class="paragraph">
<p>In <a href="#address-translation-example">Address Translation Example</a>, the <code>soc</code> node specifies a <em>ranges</em> property of</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;0x0 0xe0000000 0x00100000&gt;;</pre>
</div>
</div>
<div class="paragraph">
<p>This property value specifies that for an 1024KB range of address space,
a child node addressed at physical 0x0 maps to a parent address of
physical 0xe0000000. With this mapping, the <code>serial</code> device node can be
addressed by a load or store at address 0xe0004600, an offset of 0x4600
(specified in <em>reg</em>) plus the 0xe0000000 mapping specified in <em>ranges</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dma_ranges">2.3.9. dma-ranges</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>dma-ranges</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;empty&gt;</em> or <em>&lt;prop-encoded-array&gt;</em> encoded as arbitrary number
of triplets of (<em>child-bus-address</em>, <em>parent-bus-address</em>, <em>length</em>).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>dma-ranges</em> property is used to describe the direct memory access
(DMA) structure of a memory-mapped bus whose device tree parent can be
accessed from DMA operations originating from the bus. It provides a
means of defining a mapping or translation between the physical address
space of the bus and the physical address space of the parent of the
bus.</p>
</div>
<div class="paragraph">
<p>The format of the value of the <em>dma-ranges</em> property is an arbitrary
number of triplets of (<em>child-bus-address</em>, <em>parent-bus-address, _length</em>).
Each triplet specified describes a contiguous DMA address range.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>child-bus-address</em> is a physical address within the child bus'
address space. The number of cells to represent the address depends on
the bus and can be determined from the <em>#address-cells</em> of this node
(the node in which the <em>dma-ranges</em> property appears).</p>
</li>
<li>
<p>The <em>parent-bus-address</em> is a physical address within the parent bus'
address space.  The number of cells to represent the parent address is
bus dependent and can be determined from the <em>#address-cells</em> property
of the node that defines the parent&#8217;s address space.</p>
</li>
<li>
<p>The <em>length</em> specifies the size of the range in the child&#8217;s address
space. The number of cells to represent the size can be determined
from the <em>#size-cells</em> of this node (the node in which the dma-ranges
property appears).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_name">2.3.10. name</h4>
<div class="sidebarblock">
<div class="content">
<div class="title">Compatibility Note</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>name</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;string&gt;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>name</em> property is a string specifying the name of the node. This
property is deprecated, and its use is not recommended. However, it
might be used in older non-ePAPR-compliant device trees.  Operating
system should determine a node&#8217;s name based on the <em>name</em> component of the
node name (see section 2.2.1).</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_device_type">2.3.11. device_type</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>device_type</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>&lt;string&gt;</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>device_type</em> property was used in IEEE 1275 to describe the device&#8217;s
FCode programming model. Because ePAPR does not have FCode, new use of
the property is deprecated, and it should be included only on cpu and
memory nodes for compatibility with IEEE 1275–derived device trees.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interrupts_and_interrupt_mapping">2.4. Interrupts and Interrupt Mapping</h3>
<div class="paragraph">
<p>The ePAPR adopts the interrupt tree model of representing interrupts
specified in <em>Open Firmware Recommended Practice: Interrupt Mapping,
Version 0.9</em> <a href="#b7">[b7]</a>. Within the device tree a logical interrupt tree exists
that represents the hierarchy and routing of interrupts in the platform
hardware. While generically referred to as an interrupt tree it is more
technically a directed acyclic graph.</p>
</div>
<div class="paragraph">
<p>The physical wiring of an interrupt source to an interrupt controller is
represented in the device tree with the <em>interrupt-parent</em> property. Nodes
that represent interrupt-generating devices contain an <em>interrupt-parent</em>
property which has a <em>phandle</em> value that points to the device to which
the device&#8217;s interrupts are routed, typically an interrupt controller.
If an interrupt-generating device does not have an <em>interrupt-parent</em>
property, its interrupt parent is assumed to be its device tree parent.</p>
</div>
<div class="paragraph">
<p>Each interrupt generating device contains an <em>interrupts</em> property with a
value describing one or more interrupt sources for that device—each
source represented with information called an <em>interrupt specifier</em>. The
format and meaning of an <em>interrupt specifier</em> is interrupt domain
specific, i.e., it is dependent on properties on the node at the root of
its interrupt domain. The <em>#interrupt-cells</em> property is used by the root
of an interrupt domain to define the number of <em>&lt;u32&gt;</em> values needed to
encode an interrupt specifier. For example, for an Open PIC interrupt
controller, an interrupt-specifer takes two 32-bit values and consists
of an interrupt number and level/sense information for the interrupt.</p>
</div>
<div class="paragraph">
<p>An interrupt domain is the context in which an interrupt specifier is
interpreted. The root of the domain is either (1) an interrupt
controller or (2) an interrupt nexus.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An <em>interrupt controller</em> is physical device and will need a driver to
handle interrupts routed through it. It may also cascade into another
interrupt domain. An interrupt controller is specified by the presence
of an <em>interrupt-controller</em> property on that node in the device tree.</p>
</li>
<li>
<p>An <em>interrupt nexus</em> defines a translation between one interrupt domain
and another. The translation is based on both domain-specific and
bus-specific information. This translation between domains is performed
with the <em>interrupt-map</em> property. For example, a PCI controller device
node could be an interrupt nexus that defines a translation from the PCI
interrupt namespace (INTA, INTB, etc.) to an interrupt controller with
Interrupt Request (IRQ) numbers.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The root of the interrupt tree is determined when traversal of the
interrupt tree reaches an interrupt controller node without an
<em>interrupts</em> property and thus no explicit interrupt parent.</p>
</div>
<div class="paragraph">
<p>See Figure 2-5 for an example of a graphical representation of a device
tree with interrupt parent relationships shown. Figure 2-6 shows the
corresponding interrupt tree.</p>
</div>
<div class="listingblock">
<div class="title">Figure 2-5 Device Tree</div>
<div class="content">
<pre>FIXME

/
simple bus
device1

interrupt-parent = &lt;&amp;open-pic&gt;;

device2

interrupt-parent = &lt;&amp;open-pic&gt;;

open-pic
pci-host-bridge

interrupt-parent = &lt;&amp;open-pic&gt;;

slot0

interrupt-parent = &lt;&amp;pci-host-bridge&gt;;

slot1

interrupt-parent = &lt;&amp;pci-host-bridge&gt;;

pci-pci bridge
slot0

interrupt-parent = &lt;&amp;pci-host-bridge&gt;;

interrupt-parent = &lt;&amp;pci-pci-bridge&gt;;</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Figure 2-6 Interrupt Tree</div>
<div class="content">
<pre>Interrupt Tree
open-pic

Root of the
interrupt
tree

nexus
nodes

device1
device2

PCI host bridge
slot0
slot1
PCI-PCI bridge
slot0

interrupt
domains</pre>
</div>
</div>
<div class="paragraph">
<p>In the example shown in Figure 2-5 and Figure 2-6 :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>open-pic</code> interrupt controller is the root of the interrupt tree.</p>
</li>
<li>
<p>The interrupt tree root has three children—devices that route their
interrupts directly to the <code>open-pic</code></p>
<div class="ulist">
<ul>
<li>
<p><code>device1</code></p>
</li>
<li>
<p><code>device2</code></p>
</li>
<li>
<p><code>PCI bus controller</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Three interrupt domains exist—one rooted at the <code>open-pic</code> node, one at
the <code>PCI host bridge</code> node, and one at the <code>PCI-PCI bridge</code> node.</p>
</li>
<li>
<p>There are two nexus nodes— one at the <code>PCI host bridge</code> and one at the
<code>PCI-PCI bridge</code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_properties_for_interrupt_generating_devices">2.4.1. Properties for Interrupt Generating Devices</h4>
<div class="sect4">
<h5 id="_interrupts">interrupts</h5>
<div class="paragraph">
<p>Property: <em>interrupts</em></p>
</div>
<div class="paragraph">
<p>Value type: <em>&lt;prop-encoded-array&gt;</em> encoded as arbitrary number of interrupt specifiers</p>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>interrupts</em> property of a device node defines the interrupt or
interrupts that are generated by the device. The value of the <em>interrupts</em>
property consists of an arbitrary number of interrupt specifiers. The
format of an interrupt specifier is defined by the binding of the
interrupt domain root.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>A common definition of an interrupt specifier in an open PIC–compatible
interrupt domain consists of two cells—an interrupt number and
level/sense information. See the following example, which defines a
single interrupt specifier, with an interrupt number of 0xA and
level/sense encoding of 8.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>interrupts = &lt;0xA 8&gt;;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_interrupt_parent">interrupt-parent</h5>
<div class="paragraph">
<p>Property: <em>interrupt-parent</em></p>
</div>
<div class="paragraph">
<p>Value type: <em>&lt;phandle&gt;</em></p>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>Because the hierarchy of the nodes in the interrupt tree might not match
the device tree, the <em>interrupt-parent</em> property is available to make the
definition of an interrupt parent explicit.  The value is the phandle to
the interrupt parent. If this property is missing from a device, its
interrupt parent is assumed to be its device tree parent.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_properties_for_interrupt_controllers">2.4.2. Properties for Interrupt Controllers</h4>
<div class="sect4">
<h5 id="__interrupt_cells">#interrupt-cells</h5>
<div class="paragraph">
<p>Property: <em>#interrupt-cells</em></p>
</div>
<div class="paragraph">
<p>Value type: <em>&lt;u32&gt;</em></p>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>#interrupt-cells</em> property defines the number of cells required to
encode an interrupt specifier for an interrupt domain.</p>
</div>
</div>
<div class="sect4">
<h5 id="_interrupt_controller">interrupt-controller</h5>
<div class="paragraph">
<p>Property: <em>interrupt-controller</em></p>
</div>
<div class="paragraph">
<p>Value type: <em>&lt;empty&gt;</em></p>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>The presence of an <em>interrupt-controller</em> property defines a node as an
interrupt controller node.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_interrupt_nexus_properties">2.4.3. Interrupt Nexus Properties</h4>
<div class="paragraph">
<p>An interrupt nexus node shall have an <em>#interrupt-cells</em> property.</p>
</div>
<div class="sect4">
<h5 id="_interrupt_map">interrupt-map</h5>
<div class="paragraph">
<p>Property: <em>interrupt-map</em></p>
</div>
<div class="paragraph">
<p>Value type: <em>&lt;prop-encoded-array&gt;</em> encoded as an arbitrary number of interrupt mapping entries.</p>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>An <em>interrupt-map</em> is a property on a nexus node that bridges one
interrupt domain with a set of parent interrupt domains and specifies
how interrupt specifiers in the child domain are mapped to their
respective parent domains.</p>
</div>
<div class="paragraph">
<p>The interrupt map is a table where each row is a mapping entry
consisting of five components: <em>child unit address</em>, <em>child interrupt
specifier</em>, <em>interrupt-parent</em>, <em>parent unit address</em>, <em>parent interrupt
specifier</em>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">child unit address</dt>
<dd>
<p>The unit address of the child node being mapped.
The number of 32-bit cells required to specify this is described by the
<em>#address-cells</em> property of the bus node on which the child is located.</p>
</dd>
<dt class="hdlist1">child interrupt specifier</dt>
<dd>
<p>The interrupt specifier of the child node
being mapped.  The number of 32-bit cells required to specify this
component is described by the <em>#interrupt-cells</em> property of this node—the
nexus node containing the <em>interrupt-map</em> property.</p>
</dd>
<dt class="hdlist1">interrupt-parent</dt>
<dd>
<p>A single <em>&lt;phandle&gt;</em> value that points to the interrupt
parent to which the child domain is being mapped.</p>
</dd>
<dt class="hdlist1">parent unit address</dt>
<dd>
<p>The unit address in the domain of the interrupt
parent. The number of 32-bit cells required to specify this address is
described by the <em>#address-cells</em> property of the node pointed to by the
interrupt-parent field.</p>
</dd>
<dt class="hdlist1">parent interrupt specifier</dt>
<dd>
<p>The interrupt specifier in the parent
domain. The number of 32-bit cells required to specify this component is
described by the <em>#interrupt-cells</em> property of this node—the nexus node
containing the <em>interrupt-map</em> property.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Lookups are performed on the interrupt mapping table by matching a
unit-address/interrupt specifier pair against the child components in
the interrupt-map. Because some fields in the unit interrupt specifier
may not be relevant, a mask is applied before the lookup is done. This
mask is defined in the <em>interrupt-map-mask</em> property (see section
2.4.3.2).</p>
</div>
<div class="paragraph">
<p>Note: Both the child node and the interrupt parent node are required to
have <em>#address-cells</em> and <em>#interrupt-cells</em> properties defined. If a unit
address component is not required, <em>#address-cells</em> shall be explicitly
defined to be zero.</p>
</div>
</div>
<div class="sect4">
<h5 id="_interrupt_map_mask">interrupt-map-mask</h5>
<div class="paragraph">
<p>Property: <em>interrupt-map-mask</em></p>
</div>
<div class="paragraph">
<p>Value type: <em>&lt;prop-encoded-array&gt;</em> encoded as a bit mask</p>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>An <em>interrupt-map-mask</em> property is specified for a nexus node in the
interrupt tree. This property specifies a mask that is applied to the
incoming unit interrupt specifier being looked up in the table specified
in the <em>interrupt-map</em> property.</p>
</div>
</div>
<div class="sect4">
<h5 id="__interrupt_cells_2">#interrupt-cells</h5>
<div class="paragraph">
<p>Property: <em>#interrupt-cells</em></p>
</div>
<div class="paragraph">
<p>Value type: &lt;u32&gt;</p>
</div>
<div class="paragraph">
<div class="title">Description</div>
<p>The <em>#interrupt-cells</em> property defines the number of cells required to
encode an interrupt specifier for an interrupt domain.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_interrupt_mapping_example">2.4.4. Interrupt Mapping Example</h4>
<div class="paragraph">
<p>Figure 2-7 shows the representation of a fragment of a device tree with
a PCI bus controller and a sample interrupt map for describing the
interrupt routing for two PCI slots (IDSEL 0x11,0x12). The INTA, INTB,
INTC, and INTD pins for slots 1 and 2 are wired to the Open PIC
interrupt controller.</p>
</div>
<div class="listingblock">
<div class="title">Figure 2-7 Interrupt Mapping Example</div>
<div class="content">
<pre>FIXME
/
compatible = "simple-bus";
#address-cells = &lt;1&gt;;
#size-cells = &lt;1&gt;;

soc

open-pic

pci

open-pic:
clock-frequency = &lt;0&gt;;
interrupt-controller;
#address-cells = &lt;0&gt;;
#interrupt-cells = &lt;2&gt;;

#interrupt-cells = &lt;1&gt;;
#size-cells = &lt;2&gt;;
#address-cells = &lt;3&gt;;
interrupt-map-mask = &lt;0xf800 0 0
interrupt-map = &lt;
/* IDSEL 0x11 - PCI slot 1 */
0x8800 0 0 1 &amp;open-pic 2 1 /*
0x8800 0 0 2 &amp;open-pic 3 1 /*
0x8800 0 0 3 &amp;open-pic 4 1 /*
0x8800 0 0 4 &amp;open-pic 1 1 /*
/* IDSEL
0x9000 0
0x9000 0
0x9000 0
0x9000 0
&gt;;


0x12 - PCI slot
0 1 &amp;open-pic 3
0 2 &amp;open-pic 4
0 3 &amp;open-pic 1
0 4 &amp;open-pic 2

2 */
1 /*
1 /*
1 /*
1 /*

7&gt;;

INTA
INTB
INTC
INTD

*/
*/
*/
*/

INTA
INTB
INTC
INTD

*/
*/
*/
*/</pre>
</div>
</div>
<div class="paragraph">
<p>One Open PIC interrupt controller is represented and is identified as an
interrupt controller with an <em>interrupt-controller</em> property.</p>
</div>
<div class="paragraph">
<p>Each row in the interrupt-map table consists of five parts—a child unit
address and interrupt specifier, which is mapped to an <em>interrupt-parent</em>
node with a specified parent unit address and interrupt specifier.</p>
</div>
<div class="paragraph">
<p>For example, the first row of the interrupt-map table specifies the
mapping for INTA of slot 1.  The components of that row are shown in the
following diagram.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FIXME
0x8800 0 0
child unit
address



1
child
interrupt
specifier

&amp;open-pic

2 1
parent
interrupt parent
interrupt
parent
unit address specifier
is empty</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The child unit address is <code>&lt;0x8800 0 0&gt;</code>. This value is encoded with
three 32-bit cells, which is determined by the value of the
<em>#address-cells</em> property (value of 3) of the PCI controller. The three
cells represent the PCI address as described by the binding for the
PCI bus.</p>
<div class="ulist">
<ul>
<li>
<p>The encoding includes the bus number (0x0 &lt;&lt; 16), device number (0x11
&lt;&lt; 11), and function number (0x0 &lt;&lt; 8).</p>
</li>
</ul>
</div>
</li>
<li>
<p>The child interrupt specifier is <code>&lt;1&gt;</code>, which specifies INTA as
described by the PCI binding. This takes one 32-bit cell as specified
by the <em>#interrupt-cells</em> property (value of 1) of the PCI controller,
which is the child interrupt domain.</p>
</li>
<li>
<p>The interrupt parent is specified by a phandle which points to the
interrupt parent of the slot, the Open PIC interrupt controller.</p>
</li>
<li>
<p>The parent has no unit address because the parent interrupt domain
(the open-pic node) has an <em>#address-cells</em> value of 0.</p>
</li>
<li>
<p>The parent interrupt specifier is &lt;2 1&gt;. The number of cells to
represent the interrupt specifier (two cells) is determined by
the <em>#interrupt-cells</em> property on the interrupt parent, the open-pic
node.</p>
<div class="ulist">
<ul>
<li>
<p>The value <code>&lt;2 1&gt;</code> is a value specified by the device binding for the
Open PIC interrupt controller (see section 6.5). The value <code>&lt;2&gt;</code>
specifies the physical interrupt source number on the interrupt
controller to which INTA is wired. The value &lt;1&gt; specifies the
level/sense encoding.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this example, the interrupt-map-mask property has a value of
&lt;0xf800 0 0 7&gt;. This mask is applied to a child unit interrupt
specifier before performing a lookup in the interruptmap table.</p>
</div>
<div class="paragraph">
<p>To perform a lookup of the open-pic interrupt source number for INTB for
IDSEL 0x12 (slot 2), function 0x3, the following steps would be
performed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The child unit address and interrupt specifier form the value <code>&lt;0x9300 0 0 2&gt;</code>.</p>
<div class="ulist">
<ul>
<li>
<p>The encoding of the address includes the bus number (0x0 &lt;&lt; 16),
device number (0x12 &lt;&lt; 11), and function number (0x3 &lt;&lt; 8).</p>
</li>
<li>
<p>The interrupt specifier is 2, which is the encoding for INTB as per
the PCI binding.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The interrupt-map-mask value <code>&lt;0xf800 0 0 7&gt;</code> is applied, giving a
result of <code>&lt;0x9000 0 0 2&gt;</code>.</p>
</li>
<li>
<p>That result is looked up in the <em>interrupt-map</em> table, which maps to the
parent interrupt specifier <code>&lt;4 1&gt;</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_device_node_requirements">3. Device Node Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_base_device_node_types">3.1. Base Device Node Types</h3>
<div class="paragraph">
<p>The sections that follow specify the requirements for the base set of
device nodes required in an ePAPR-compliant device tree.</p>
</div>
<div class="paragraph">
<p>All device trees shall have a root node and the following nodes shall be
present at the root of all device trees:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One <em>cpus</em> node</p>
</li>
<li>
<p>At least one <em>memory</em> node</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_root_node">3.2. Root node</h3>
<div class="paragraph">
<p>The device tree has a single root node of which all other device nodes
are descendants. The full path to the root node is /.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Table 3-1 Root Node Properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#address-cells</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of &lt;u32&gt; cells to
represent the address in the <em>reg</em> property in children of root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#size-cells</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of &lt;u32&gt; cells to represent
the size in the <em>reg</em> property in children of root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">model</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a string that uniquely identifies the
model of the system board. The recommended format is
“manufacturer,model-number”.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;stringlist&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Specifies a list of platform
architectures with which this platform is compatible. This property can
be used by operating systems in selecting platform specific code. The
recommended form of the property value is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>“&lt;Manufacturer&gt;,&lt;Model-number&gt;”</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>compatible = “fsl,mpc8572ds”</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">epapr-version</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This property shall contain the string: “ePAPR-&lt;ePAPR version&gt;”</p>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>&lt;ePAPR version&gt; is the text (without blanks) after the word
Version on the cover page of the PAPR spec that the platform
adheres to</p>
</div>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>epapr-version = “{spec}-1.1”</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
</div>
<div class="sect2">
<h3 id="_aliases_node">3.3. aliases node</h3>
<div class="paragraph">
<p>A device tree may have an aliases node (/aliases) that defines one or
more alias properties. The alias node shall be at the root of the device
tree and have the node name aliases.</p>
</div>
<div class="paragraph">
<p>Each property of the /aliases node defines an alias. The property name
specifies the alias name.  The property value specifies the full path to
a node in the device tree. For example, the property serial0 =
“/simple-bus@fe000000/serial@llc500” defines the alias serial0.</p>
</div>
<div class="paragraph">
<p>Alias names shall be a lowercase text strings of 1 to 31 characters from
the following set of characters.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 50%;">
<caption class="title">Table 7. Characters for alias names</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Character</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0-9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">digit</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">a-z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lowercase letter</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dash</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An alias value is a device path and is encoded as a string. The value
represents the full path to a node, but the path does not need to refer
to a leaf node.</p>
</div>
<div class="paragraph">
<p>A client program may use an alias property name to refer to a full
device path as all or part of its string value. A client program, when
considering a string as a device path, shall detect and use the alias.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>aliases {
	serial0 = "/simple-bus@fe000000/serial@llc500";
	ethernet0 = "/simple-bus@fe000000/ethernet@31c000";
}</pre>
</div>
</div>
<div class="paragraph">
<p>Given the alias serial0, a client program can look at the /aliases node
and determine the alias refers to the device path
/simple-bus@fe000000/serial@llc500.</p>
</div>
</div>
<div class="sect2">
<h3 id="_memory_node">3.4. Memory node</h3>
<div class="paragraph">
<p>A memory device node is required for all device trees and describes the
physical memory layout for the system. If a system has multiple ranges
of memory, multiple memory nodes can be created, or the ranges can be
specified in the <em>reg</em> property of a single memory node.</p>
</div>
<div class="paragraph">
<p>The name component of the node name (see 2.2.1) shall be memory.</p>
</div>
<div class="paragraph">
<p>The client program may access memory not covered by any memory
reservations (see section 8.3) using any storage attributes it chooses.
However, before changing the storage attributes used to access a real
page, the client program is responsible for performing actions required
by the architecture and implementation, possibly including flushing the
real page from the caches. The boot program is responsible for ensuring
that, without taking any action associated with a change in storage
attributes, the client program can safely access all memory (including
memory covered by memory reservations) as WIMG = 0b001x. That is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>not Write Through Required not Caching Inhibited Memory Coherence</p>
</li>
<li>
<p>Required either not Guarded or Guarded (i.e., WIMG = 0b001x)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the VLE storage attribute is supported, with VLE=0.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. Memory node properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">device_type</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value shall be "memory"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reg</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;prop-encoded-array&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consists of an arbitrary number of address and size pairs that specify
the physical address and size of the memory ranges.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">initial-mapped-area</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">O</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;prop-encoded-array&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the address and size of the Initial Mapped Area (see section 5.3).
</p><p class="tableblock">Is a prop-encoded-array consisting of a triplet of (effective address,
physical address, size). The effective and physical address shall each
be 64-bit (&lt;u64&gt; value), and the size shall be 32-bits (&lt;u32&gt; value).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>Given a 64-bit Power system with the following physical memory layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RAM: starting address 0x0, length 0x80000000 (2GB)</p>
</li>
<li>
<p>RAM: starting address 0x100000000, length 0x100000000 (4GB)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Memory nodes could be defined as follows, assuming an <em>#address-cells</em>
value of 2 and a <em>#size-cells</em> value of 2:</p>
</div>
<div class="listingblock">
<div class="title">Example #1</div>
<div class="content">
<pre>memory@0 {
	device_type = "memory";
	reg = &lt;0x000000000 0x00000000 0x00000000 0x80000000
	       0x000000001 0x00000000 0x00000001 0x00000000&gt;;
};</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example #2</div>
<div class="content">
<pre>memory@0 {
	device_type = "memory";
	reg = &lt;0x000000000 0x00000000 0x00000000 0x80000000&gt;;
};
memory@100000000 {
	device_type = "memory";
	reg = &lt;0x000000001 0x00000000 0x00000001 0x00000000&gt;;
};</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>reg</em> property is used to define the address and size of the two
memory ranges. The 2 GB I/O region is skipped. Note that the
<em>#address-cells</em> and <em>#size-cells</em> properties of the root node specify a
value of 2, which means that two 32-bit cells are required to define the
address and length for the <em>reg</em> property of the memory node.</p>
</div>
</div>
<div class="sect2">
<h3 id="_chosen">3.5. Chosen</h3>
<div class="paragraph">
<p>The chosen node does not represent a real device in the system but
describes parameters chosen or specified by the system firmware at run
time. It shall be a child of the root node.</p>
</div>
<div class="paragraph">
<p>The node name (see 2.2.1) shall be chosen.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. Chosen node properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bootargs</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">O</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string that specifies the boot arguments for
the client program. The value could potentially be a null string if no
boot arguments are required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stdout-path</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">O</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string that specifies the full path to the
node representing the device to be used for boot console output. If the
character ":" is present in the value it terminates the path. The value
may be an alias.
</p><p class="tableblock">If the stdin-path property is not specified, stdout-path should be
assumed to define the input device.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stdin-path</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">O</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string that specifies the full path to the
node representing the device to be used for boot console input. If the
character ":" is present in the value it terminates the path. The value
may be an alias.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>chosen {
	bootargs = “root=/dev/nfs rw nfsroot=192.168.1.1 console=ttyS0,115200”;
};</pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Compatibility Note</div>
<div class="paragraph">
<p>Older versions of device trees may be encountered that contain a
deprecated form of the stdout-path property called linux,stdout-path.
For compatibility, a client program might want to support
linux,stdout-path if a stdout-path property is not present. The meaning
and use of the two properties is identical.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cpus_node_properties">3.6. CPUS Node Properties</h3>
<div class="paragraph">
<p>A cpus node is required for all device trees. It does not represent a
real device in the system, but acts as a container for child cpu nodes
which represent the systems CPUs.</p>
</div>
<div class="paragraph">
<p>The node name (see 2.2.1) shall be cpus.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. cpus node properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#address-cells</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value specifies how many cells each
element of the <em>reg</em> property array takes in children of this node.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#size-cells</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value shall be 0. Specifies that no size is
required in the <em>reg</em> property in children of this node.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended,
SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are
optional.</p>
</div>
<div class="paragraph">
<p>The cpus node may contain properties that are common across CPU nodes.
See section 3.7 for details.</p>
</div>
<div class="paragraph">
<p>For an example, see section 3.7.4.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cpu_node_properties">3.7. CPU Node Properties</h3>
<div class="paragraph">
<p>A cpu node represents a hardware execution block that is sufficiently
independent that it is capable of running an operating system without
interfering with other CPUs possibly running other operating systems.</p>
</div>
<div class="paragraph">
<p>Hardware threads that share an MMU would generally be represented under
one cpu node. If other more complex CPU topographies are designed, the
binding for the CPU must describe the topography (e.g. threads that
don&#8217;t share an MMU).</p>
</div>
<div class="paragraph">
<p>CPUs and threads are numbered through a unified number-space that should
match as closely as possible the interrupt controller&#8217;s numbering of
CPUs/threads.</p>
</div>
<div class="paragraph">
<p>Properties that have identical values across CPU nodes may be placed in
the cpus node instead. A client program must first examine a specific
CPU node, but if an expected property is not found then it should look
at the parent cpus node. This results in a less verbose representation
of properties which are identical across all CPUs.</p>
</div>
<div class="paragraph">
<p>The node name for every cpu node (see 2.2.1) should be cpu.</p>
</div>
<div class="sect3">
<h4 id="_general_properties_of_cpu_nodes">3.7.1. General Properties of CPU nodes</h4>
<div class="paragraph">
<p>The following table describes the general properties of CPU nodes. Some
of the properties described in <a href="#cpu-node-properties">cpu node general properties</a> are select standard properties
with specific applicable detail.</p>
</div>
<table id="cpu-node-properties" class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. cpu node general properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">device_type</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value shall be “cpu”.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reg</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;propencodedarray&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The value of "reg" is a
&lt;prop-encoded-array&gt; that defines a unique CPU/thread id for the
CPU/threads represented by the CPU node.</p>
</div>
<div class="paragraph">
<p>If a CPU supports more than one thread (i.e. multiple streams of
execution) the <em>reg</em> property is an array with 1 element per thread. The
<em>#address-cells</em> on the /cpus node specifies how many cells each element
of the array takes. Software can determine the number of threads by
dividing the size of <em>reg</em> by the parent node&#8217;s <em>#address-cells</em>.</p>
</div>
<div class="paragraph">
<p>If a CPU/thread can be the target of an external interrupt the "reg"
property value must be a unique CPU/thread id that is addressable by
the interrupt controller.</p>
</div>
<div class="paragraph">
<p>If a CPU/thread cannot be the target of an external interrupt, then "reg"
must be unique and out of bounds of the range addressed by the
interrupt controller</p>
</div>
<div class="paragraph">
<p>If a CPU/thread&#8217;s PIR is modifiable, a client program should modify
PIR to match the "reg" property value. If PIR cannot be modified and
the PIR value is distinct from the interrupt controller numberspace, the
CPUs binding may define a binding-specific representation of PIR
values if desired.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">clock-frequency</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;propencodedarray&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Specifies the current clock
speed of the CPU in Hertz. The value is a &lt;prop-encoded-array&gt; in one of
two forms:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A 32-bit integer consisting of one &lt;u32&gt; specifying the frequency.</p>
</li>
<li>
<p>A 64-bit integer represented as a &lt;u64&gt; specifying the frequency.</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timebase-frequency</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;propencodedarray&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the current
frequency at which the timebase and decrementer registers are updated
(in Hertz). The value is a &lt;prop-encoded-array&gt; in one of two forms:
</p><p class="tableblock">1. A 32-bit integer consisting of one &lt;u32&gt; specifying the frequency.
2. A 64-bit integer represented as a &lt;u64&gt;.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-op-block-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the block size in bytes upon
which cache block instructions operate (e.g., dcbz). Required if
different than the L1 cache block size.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reservation-granule-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the reservation granule
size supported by this processor in bytes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">status</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A standard property describing the state of a
CPU. This property shall be present for nodes representing CPUs in a
symmetric multiprocessing (SMP) configuration. For a CPU node the
meaning of the “okay” and “disabled” values are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>“okay”. The CPU is running.</p>
</li>
<li>
<p>“disabled”. The CPU is in a quiescent state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A quiescent CPU is in a state where it cannot interfere with the normal
operation of other CPUs, nor can its state be affected by the normal
operation of other running CPUs, except by an explicit method for
enabling or reenabling the quiescent CPU (see the enable-method
property).</p>
</div>
<div class="paragraph">
<p>In particular, a running CPU shall be able to issue broadcast
TLB invalidates without affecting a quiescent CPU.</p>
</div>
<div class="paragraph">
<p>Examples: A quiescent CPU could be in a spin loop, held in
reset, and electrically isolated from the system bus or in
another implementation dependent state.</p>
</div>
<div class="paragraph">
<p>Note: See section 5.5 (Symmetric Multiprocessing (SMP) Boot
Requirements) for a description of how these values are used for
booting multi-CPU SMP systems.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enable-method</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;stringlist&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Describes the method by which a CPU in
a disabled state is enabled.  This property is required for CPUs with a
status property with a value of “disabled”. The value consists of one or
more strings that define the method to release this CPU. If a client
program recognizes any of the methods, it may use it. The value shall be
one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"spin-table" The CPU is enabled with the spin table method
defined in the ePAPR.</p>
</li>
<li>
<p>"[vendor],[method]" An implementation-dependent string
that describes the method by which a CPU is released from a "disabled"
state. The required format is: "vendor,method" where vendor is a string
describing the name of the manufacturer and method is a string
describing the vendorspecific mechanism.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example: "fsl,MPC8572DS"</p>
</div>
<div class="paragraph">
<p>Note: Other methods may be added to later revisions of the ePAPR
specification.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cpu-release-addr</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u64&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The cpu-release-addr property is required
for cpu nodes that have an enable-method property value of "spin-table".
The value specifies the physical address of a spin table entry that
releases a secondary CPU from its spin loop.</p>
</div>
<div class="paragraph">
<p>See section 5.5.2, Spin Table or details on the structure of a spin table.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">power-isa-version</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">O</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string that specifies the numerical
portion of the Power ISA version string. For example, for an
implementation complying with Power ISA Version 2.06, the value of this
property would be "2.06".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">power-isa-*</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">O</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;empty&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>If the power-isa-version property exists, then
for each category from the Categories section of Book I of the Power ISA
version indicated, the existence of a property named power-isa-[CAT],
where [CAT] is the abbreviated category name with all uppercase letters
converted to lowercase, indicates that the category is supported by the
implementation.</p>
</div>
<div class="paragraph">
<p>For example, if the power-isa-version property exists and its value is
"2.06" and the power-isa-e.hv property exists, then the implementation
supports [Category:Embedded.Hypervisor] as defined in Power ISA
Version 2.06.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mmu-type</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">O</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Specifies the CPU&#8217;s MMU type.</p>
</div>
<div class="paragraph">
<p>Valid values are shown below:</p>
</div>
<div class="verseblock">
<pre class="content">"mpc8xx"
"ppc40x"
"ppc440"
"ppc476"
"power-embedded"
"powerpc-classic"
"power-server-stab"
"power-server-slb"
"none"</pre>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition
Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Compatibility Note</div>
<div class="paragraph">
<p>Older versions of device trees may be encountered that contain a bus-frequency property on
CPU nodes. For compatibility, a client-program might want to support bus-frequency. The
format of the value is identical to that of clock-frequency. The recommended practice is to
represent the frequency of a bus on the bus node using a clock-frequency property.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tlb_properties">3.7.2. TLB Properties</h4>
<div class="paragraph">
<p>The following properties of a cpu node describe the translate look-aside
buffer in the processor&#8217;s MMU.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 12. Table 3-7, cpu node TLB properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tlb-split</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;empty&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>If present specifies that the TLB has a split
configuration, with separate TLBs for instructions and data. If absent,
specifies that the TLB has a unified configuration. Required for a CPU
with a TLB in a split configuration.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tlb-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of entries in the TLB.
Required for a CPU with a unified TLB for instruction and data
addresses.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tlb-sets</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of associativity sets in the
TLB.  Required for a CPU with a unified TLB for instruction and data
addresses.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d-tlb-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of entries in the data TLB.
Required for a CPU with a split TLB configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d-tlb-sets</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of associativity sets in
the data TLB.  Required for a CPU with a split TLB configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">i-tlb-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of entries in the
instruction TLB.  Required for a CPU with a split TLB configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">i-tlb-sets</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of associativity sets in
the instruction TLB.  Required for a CPU with a split TLB configuration.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
</div>
<div class="sect3">
<h4 id="_internal_l1_cache_properties">3.7.3. Internal (L1) Cache Properties</h4>
<div class="paragraph">
<p>The following properties of a cpu node describe the processor&#8217;s internal (L1) cache.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 13. Table 3-8 Cache properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-unified</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;empty&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If present, specifies the cache has a unified organization. If not present, specifies that the cache has a Harvard architecture with separate caches for instructions and data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the size in bytes of a unified cache.
Required if the cache is unified (combined instructions and data).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-sets</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of associativity sets in a
unified cache.  Required if the cache is unified (combined instructions
and data)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-block-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the block size in bytes of a
unified cache. Required if the processor has a unified cache (combined
instructions and data)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-line-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the line size in bytes of a
unified cache, if different than the cache block size Required if the
processor has a unified cache (combined instructions and data).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">i-cache-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the size in bytes of the instruction
cache.  Required if the cpu has a separate cache for instructions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">i-cache-sets</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of associativity sets in
the instruction cache.  Required if the cpu has a separate cache for
instructions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">i-cache-block-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the block size in bytes of the
instruction cache.  Required if the cpu has a separate cache for
instructions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">i-cache-line-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the line size in bytes of the
instruction cache, if different than the cache block size.  Required if
the cpu has a separate cache for instructions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d-cache-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the size in bytes of the data cache.
Required if the cpu has a separate cache for data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d-cache-sets</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of associativity sets in
the data cache.  Required if the cpu has a separate cache for data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d-cache-block-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the block size in bytes of the
data cache.  Required if the cpu has a separate cache for data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d-cache-line-size</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the line size in bytes of the
data cache, if different than the cache block size.  Required if the cpu
has a separate cache for data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">next-level-cache</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;phandle&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If present, indicates that another
level of cache exists. The value is the phandle of the next level of
cache. The phandle value type is fully described in section 2.3.3.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Compatibility Note</div>
<div class="paragraph">
<p>Older versions of device trees may be encountered that contain a deprecated form of the
next-level-cache property called l2-cache. For compatibility, a client-program may wish to
support l2-cache if a next-level-cache property is not present. The meaning and use of the
two properties is identical.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example">3.7.4. Example</h4>
<div class="paragraph">
<p>Here is an example of a cpus node with one child cpu node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cpus {
	#address-cells = &lt;1&gt;;
	#size-cells = &lt;0&gt;;
	cpu@0 {
		device_type = "cpu";
		reg = &lt;0&gt;;
		d-cache-block-size = &lt;32&gt;; // L1 - 32 bytes
		i-cache-block-size = &lt;32&gt;; // L1 - 32 bytes
		d-cache-size = &lt;0x8000&gt;; // L1, 32K
		i-cache-size = &lt;0x8000&gt;; // L1, 32K
		timebase-frequency = &lt;82500000&gt;; // 82.5 MHz
		clock-frequency = &lt;825000000&gt;; // 825 MHz
	};
};</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multi_level_and_shared_caches">3.8. Multi-level and Shared Caches</h3>
<div class="paragraph">
<p>Processors and systems may implement additional levels of cache
hierarchy—for example, secondlevel (L2) or third-level (L3) caches.
These caches can potentially be tightly integrated to the CPU or
possibly shared between multiple CPUs.</p>
</div>
<div class="paragraph">
<p>A device node with a compatible value of "cache" describes these types
of caches.</p>
</div>
<div class="paragraph">
<p>The cache node shall define a phandle property, and all cpu nodes or
cache nodes that are associated with or share the cache each shall
contain a next-level-cache property that specifies the phandle to the
cache node.</p>
</div>
<div class="paragraph">
<p>A cache node may be represented under a CPU node or any other
appropriate location in the device tree.</p>
</div>
<div class="paragraph">
<p>Multiple-level and shared caches are represented with the properties in
Table 3-9. The L1 cache properties are described in Table 3-8.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 14. Table 3-9 Multiple-level and shared cache properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A standard property. The value shall include the
string “cache”</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-level</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the level in the cache hierarchy. For
example, a level 2 cache
has a value of &lt;2&gt;.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>See the following example of a device tree representation of two CPUs, each
with their own on-chip L2 and a shared L3.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cpus {
	#address-cells = &lt;1&gt;;
	#size-cells = &lt;0&gt;;
	cpu@0 {
		device_type = "cpu";
		reg = &lt;0&gt;;
		cache-unified;
		cache-size = &lt;0x8000&gt;; // L1, 32KB
		cache-block-size = &lt;32&gt;;
		timebase-frequency = &lt;82500000&gt;; // 82.5 MHz
		next-level-cache = &lt;&amp;L2_0&gt;; // phandle to L2

		L2_0:l2-cache {
			compatible = “cache”;
			cache-unified;
			cache-size = &lt;0x40000&gt;; // 256 KB

			cache-sets = &lt;1024&gt;;
			cache-block-size = &lt;32&gt;;
			cache-level = &lt;2&gt;;
			next-level-cache = &lt;&amp;L3&gt;; // phandle to L3

			L3:l3-cache {
				compatible = “cache”;
				cache-unified;
				cache-size = &lt;0x40000&gt;; // 256 KB
				cache-sets = &lt;0x400&gt;; // 1024
				cache-block-size = <b class="conum">(32)</b>
				cache-level = &lt;3&gt;;
			};
		};
	};

	cpu@1 {
		device_type = "cpu";
		reg = &lt;0&gt;;
		cache-unified;
		cache-block-size = &lt;32&gt;;
		cache-size = &lt;0x8000&gt;; // L1, 32KB
		timebase-frequency = &lt;82500000&gt;; // 82.5 MHz
		clock-frequency = &lt;825000000&gt;; // 825 MHz
		cache-level = &lt;2&gt;;
		next-level-cache = &lt;&amp;L2_1&gt;; // phandle to L2
		L2_1:l2-cache {
			compatible = “cache”;
			cache-unified;
			cache-size = &lt;0x40000&gt;; // 256 KB
			cache-sets = &lt;0x400&gt;; // 1024
			cache-line-size = &lt;32&gt; // 32 bytes
			next-level-cache = &lt;&amp;L3&gt;; // phandle to L3
		};
	};
};</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_client_program_image_format">4. Client Program Image Format</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the image format in which an ePAPR client is
encoded in order to boot it from an ePAPR-compliant boot program. Two
variants on the image format are described: variable-address images and
fixed-address images. ePAPR-compliant boot programs shall support client
images in the variable-address format, should support images in the
fixed-address format, and may also support other formats not described
in this document.</p>
</div>
<div class="sect2">
<h3 id="_variable_address_image_format">4.1. Variable Address Image Format</h3>
<div class="paragraph">
<p>This ePAPR image format is a constrained form of ELF (Executable and
Linking Format, see <a href="#b17">[b17]</a>) executable. That is, an ePAPR client image
shall be a valid ELF file, but also has additional requirements
described in the next sections.</p>
</div>
<div class="sect3">
<h4 id="_elf_basics">4.1.1. ELF Basics</h4>
<div class="paragraph">
<p>A variable-address client image is a 32-bit ELF client image with the
following ELF header field values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>e_ident[EI_CLASS] ELFCLASS32(0x1)
e_ident[EI_DATA]  ELFDATA2MSB(0x2)
e_type            ET_DYN(0x3)
e_machine         EM_PPC(0x14)</pre>
</div>
</div>
<div class="paragraph">
<p>That is, it is a 32-bit Power shared-object image in 2&#8217;s complement, big-endian
format.</p>
</div>
<div class="paragraph">
<p>Every ePAPR image shall have at least one program header of type PT_LOAD. It
may also have other valid ELF program headers. The client image shall be
arranged so that all its ELF program headers lie within the first 1024 bytes of
the image.</p>
</div>
</div>
<div class="sect3">
<h4 id="_boot_program_requirements">4.1.2. Boot Program Requirements</h4>
<div class="paragraph">
<p>When loading a client image, the boot program need only consider ELF segments
of type PT_LOAD.  Other segments may be present, but should be ignored by the
boot program. In particular, the boot program should not process any ELF
relocations found in the client image.</p>
</div>
<div class="sect4">
<h5 id="_processing_of_pt_load_segments">Processing of PT_LOAD segments</h5>
<div class="paragraph">
<p>The boot program shall load the contents of any PT_LOAD segments into RAM, and
then pass control to the entry point specified in the ELF header in the manner
specified in section 5.4.</p>
</div>
<div class="paragraph">
<p>Each PT_LOAD segments shall be loaded at an address decided by the boot
program, subject to the following constraints.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The load address shall be congruent with the program header&#8217;s p_paddr value,
modulo with the program header&#8217;s p_align value.</p>
</li>
<li>
<p>If there is more than one PT_LOAD segment, then the difference between the
loaded address and the address specified in the p_paddr field shall be the
same for all segments. That is, the boot program shall preserve the relative
offsets between PT_LOAD segments by physical address.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The p_vaddr field is reserved to represent the effective address at which the
segments will appear after the client program has performed MMU setup. The boot
program should not use the program header&#8217;s p_vaddr field for determining the
load address of segments.</p>
</div>
</div>
<div class="sect4">
<h5 id="_entry_point">Entry point</h5>
<div class="paragraph">
<p>The program entry point is the address of the first instruction that is to be
executed in a program image.  The ELF header e_entry field gives the effective
address of the program entry point. However, as described in section 5.4, CPU
Entry Point Requirements, the client program shall be entered either in real
mode or with an initial MMU mapping at effective address 0x0.</p>
</div>
<div class="paragraph">
<p>Therefore, the boot program shall compute the physical address of the entry
point before entering the client program. To perform this calculation, it shall
locate the program segment containing the entry point, determine the difference
between e_entry and the p_vaddr of that segment, and add this difference to the
physical address where the segment was loaded.</p>
</div>
<div class="paragraph">
<p>This adjusted address will be the physical address of the first client program
instruction executed after the boot program jumps to the client program.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_client_program_requirements">4.1.3. Client Program Requirements</h4>
<div class="paragraph">
<p>The client program is entered with MMU state as described in section 5.4, CPU
Entry Point Requirements. Therefore, the code at the client program&#8217;s entry
point shall be prepared to execute in this environment, which may be different
than the MMU environment in which most of the client program executes. The
p_vaddr fields of the client&#8217;s ELF program headers will reflect this final
environment, not the environment in which the entry point is executed.</p>
</div>
<div class="paragraph">
<p>The code at the entry point shall be written so that it can be executed at any
address. It shall establish a suitable environment in which the remainder of
the client program executes. The ePAPR does not specify its method, but the
task could involve:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Processing ELF relocations to relocate the client&#8217;s own image to its loaded
address. Note that in this case the client image shall be specially linked so
that the ELF relocation information, plus any data required to find that
information is contained in both the loaded segments and the segments and
sections set aside for relocation information.</p>
</li>
<li>
<p>Processing other tables of relocation information in some format specific to
the client program.</p>
</li>
<li>
<p>Physically copying the client image to the address at which it prefers to
execute.</p>
</li>
<li>
<p>Configuring the MMU so that the client image can execute at its preferred
effective address, regardless of the physical address at which it is loaded.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fixed_address_image_format">4.2. Fixed Address Image Format</h3>
<div class="paragraph">
<p>Fixed-address client images are identical to variable-address client images
except for the following changes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The e_type ELF header field shall have the value ET_EXEC (0x2).</p>
</li>
<li>
<p>The boot program, instead of loading each PT_LOAD segment at an address of
its choosing shall load each PT_LOAD segment at the physical address given in
the program header&#8217;s p_paddr field. If it cannot load the segment at this
address (because memory does not exist at that address or is already in use
by the boot program itself), then it shall refuse to load the image and
report an error condition.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The fixed-address image format is intended for use by very simple clients (such
as diagnostic programs), avoiding the need for such clients to physically
relocate themselves to a suitable address.</p>
</div>
<div class="paragraph">
<p>Clients should in general avoid using the fixed-address format, because
creating a usable fixedaddress image requires knowing which physical areas will
be available for client use on the platform in question.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_client_program_boot_requirements">5. Client Program Boot Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_boot_and_secondary_cpus">5.1. Boot and Secondary CPUs</h3>
<div class="paragraph">
<p>A boot cpu is the CPU on which control is transferred from the boot
program to a client program.  Other CPUs that belong to the client
program are considered secondary CPUs.</p>
</div>
<div class="paragraph">
<p>For a partition with multiple CPUs in an SMP configuration, one CPU
shall be designated as the boot cpu. The unit address of the CPU node
for the boot cpu is set in the boot_cpuid_phys field of the flattened
device tree header (see section 8.2, Header).</p>
</div>
</div>
<div class="sect2">
<h3 id="_device_tree">5.2. Device Tree</h3>
<div class="paragraph">
<p>A boot program shall load a device tree image into the client program&#8217;s
memory before transferring control to the client on the boot cpu. The
logical structure of the device tree shall comply with the requirements
specified in section 3.1 (Base Device Node Types). The physical
structure of the device tree image shall comply with the requirements
specified in chapter 8 (Flat Device Tree Physical Structure).</p>
</div>
<div class="paragraph">
<p>The loaded device tree image shall be aligned on an 8-byte boundary in
the client&#8217;s memory.</p>
</div>
</div>
<div class="sect2">
<h3 id="_initial_mapped_areas">5.3. Initial Mapped Areas</h3>
<div class="paragraph">
<p>CPUs that implement the Power ISA Book III-E embedded environment, which
run with address translation always enabled, have some unique boot
requirements related to initial memory mappings.  This section
introduces the concept of an Initial Mapped Area (or IMA), which is
applicable to Book III-E CPUs.</p>
</div>
<div class="paragraph">
<p>A client program&#8217;s IMA is a region of memory that contains the entry
points for a client program.  Both boot CPUs and secondary CPUs begin
client program execution in an IMA. The terms Boot IMA (BIMA) and
Secondary IMA (SIMA) are used to distinguish the IMAs for boot CPUs and
secondary CPUs where necessary.</p>
</div>
<div class="paragraph">
<p>All IMAs have the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An IMA shall be virtually and physically contiguous</p>
</li>
<li>
<p>An IMA shall start at effective address zero (0) which shall be
mapped to a physical address naturally aligned to the size of the IMA.</p>
</li>
<li>
<p>The mapping shall not be invalidated except by a client program&#8217;s
explicit action (i.e., not subject to broadcast invalidates from
other CPUs)</p>
</li>
<li>
<p>The Translation ID (TID) field in the TLB entry or entries shall be zero.</p>
</li>
<li>
<p>The memory and cache access attributes (WIMGE) have the following requirements:</p>
<div class="ulist">
<ul>
<li>
<p>WIMG = 001x</p>
</li>
<li>
<p>E=0 (i.e., big-endian)</p>
</li>
<li>
<p>VLE (if implemented) is set to 0</p>
</li>
</ul>
</div>
</li>
<li>
<p>An IMA may be mapped by a TLB entry larger than the IMA size,
provided the MMU guarded attribute is set (G=1)</p>
</li>
<li>
<p>An IMA may span multiple TLB entries.</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Note</div>
<div class="paragraph">
<p>Those CPUs with an IPROT capable TLB should use the IPROT facility to ensure
requirement #3.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cpu_entry_point_requirements">5.4. CPU Entry Point Requirements</h3>
<div class="paragraph">
<p>This section describes the state of the processor and system when a boot
program passes control to a client program.</p>
</div>
<div class="sect3">
<h4 id="_boot_cpu_initial_register_state">5.4.1. Boot CPU Initial Register State</h4>
<div class="paragraph">
<p>A boot CPU shall have its initial register values set as described in
the following table.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 65%;">
<caption class="title">Table 15. Table 5-1 Boot CPU initial register values</caption>
<colgroup>
<col style="width: 27%;">
<col style="width: 72%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Register</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">MSR</p></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre>PR=0 supervisor state
EE=0 interrupts disabled
ME=0 machine check interrupt disabled
IP=0 interrupt prefix-- low memory
IR=0,DR=0 real mode (see note 1)
IS=0,DS=0 address space 0 (see note 1)
SF=0, CM=0, ICM=0 32-bit mode</pre>
</div>
</div>
<div class="paragraph">
<p>The state of any additional MSR bits is defined in the
applicable processor supplement specification.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">R3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Effective address of the device tree image.
Note: This address shall be 8 bytes aligned in memory.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">R4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">R5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">R6</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>ePAPR magic value—to distinguish from non-ePAPR compliant firmware</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Book III-E CPUs shall be 0x45504150</p>
</li>
<li>
<p>For non-Book III-E CPUs shall be 0x65504150</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">R7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">shall be the size of the boot IMA in bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">R8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">R9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">TCR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRC=0, no watchdog timer reset will occur (see note 2)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">other registers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation dependent</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note 1: Applicable only to CPUs that define these bits</p>
</div>
<div class="paragraph">
<p>Note 2: Applicable to Book III-E CPUs only</p>
</div>
<div class="paragraph">
<p>On a multi-threaded processor that supports [Category: Embedded
Multi-Threading], the client program shall be entered on thread zero
with the register values defined in the preceding table. All other
threads shall be disabled and shall have register values set as defined
in the preceding table except as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>R3 shall be zero.</p>
</li>
<li>
<p>R6 shall be zero.</p>
</li>
<li>
<p>R7 shall be zero.</p>
</li>
<li>
<p>PC shall be 0x4.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Note</div>
<div class="paragraph">
<p>The boot program is expected to place a store instruction at effective
address 0x0 and a branch-to-self instruction at effective address 0x4.
The store instruction is expected to be used to set a shared variable
indicating that the thread has reached the branch-to-self instruction
and is ready to be disabled.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_i_o_devices_state">5.4.2. I/O Devices State</h4>
<div class="paragraph">
<p>The boot program shall leave all devices with the following conditions true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All devices: no DMA and not interrupting</p>
</li>
<li>
<p>Host bridges: responding to config cycles and passing through config
cycles to children</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_initial_i_o_mappings_iio">5.4.3. Initial I/O Mappings (IIO)</h4>
<div class="paragraph">
<p>A boot program might pass a client program a device tree containing
device nodes with a <em>virtual-reg</em> property (see 2.3.7, <em>virtual-reg</em>). The
<em>virtual-reg</em> property describes an Initial I/O (or IIO) mapping set up by
firmware, and the value is the effective address of a device&#8217;s
registers.</p>
</div>
<div class="paragraph">
<p>For Book III-E CPUs, effective to physical address mappings
shall be present in the CPU&#8217;s MMU to map any IIO. An IIO has the
following requirements on Book III-E CPUs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An IIO shall be virtually and physically contiguous.</p>
</li>
<li>
<p>An IIO shall map the effective address in <em>virtual-reg</em> to the physical
address at which the device appears at the point of entry.</p>
</li>
<li>
<p>An IIO shall not be invalidated except by client&#8217;s explicit action
(i.e., not subject to broadcast invalidates from other partitions).</p>
</li>
<li>
<p>The Translation ID (TID) field in the TLB entry shall be zero.</p>
</li>
<li>
<p>The memory and cache access attributes (WIMGE) have the following requirements:</p>
<div class="ulist">
<ul>
<li>
<p>WIMG shall be suitable for accessing the device in question. Typically I=1, G=1.</p>
</li>
<li>
<p>E=0 (i.e., big-endian)</p>
</li>
</ul>
</div>
</li>
<li>
<p>An IIO shall be large enough to cover all of device&#8217;s registers.</p>
</li>
<li>
<p>Multiple devices may share an IIO.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_boot_cpu_entry_requirements_real_mode">5.4.4. Boot CPU Entry Requirements: Real Mode</h4>
<div class="paragraph">
<p>For real mode (i.e., non-Book III-E) CPUs, the following requirements
apply at client entry for boot CPUs:
1. The CPU shall have address translation disabled at client entry
   (i.e., MSR[IR]=0, MSR[DR]=0).
2. All PT_LOAD segments shall be loaded into an area of memory that is
   appropriate for the platform.
3. The device tree shall be loaded into an area of memory that is
   appropriate for the platform (with the address in r3). The device
   tree must not overlap any PT_LOAD segment (taking into account the
   p_memsz field in the program header which may be different than
   p_filesz).
4. r7 shall contain the size of the contiguous physical memory available
   to the client.</p>
</div>
</div>
<div class="sect3">
<h4 id="_boot_cpu_entry_requirements_for_imas_book_iiii_e">5.4.5. Boot CPU Entry Requirements for IMAs: Book IIII-E</h4>
<div class="paragraph">
<p>For Book III-E CPUs the following requirements apply at client entry for boot CPUs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Boot IMA (BIMA) mapping in the MMU shall be mapped at effective address 0.</p>
</li>
<li>
<p>All PT_LOAD segments shall be loaded into BIMA.</p>
</li>
<li>
<p>The device tree shall be loaded into the BIMA (with the address in
r3). The device tree must not overlap any PT_LOAD segment (taking
into account the p_memsz field in the program header which may be
different than p_filesz).</p>
</li>
<li>
<p>IIOs shall be present for all devices with a <em>virtual-reg</em> property</p>
</li>
<li>
<p>Other mappings may be present in Address Space (AS) 0.</p>
</li>
<li>
<p>No mappings shall be present in Address Space (AS) 1.</p>
</li>
<li>
<p>r7 shall contain the size of the BIMA.</p>
</li>
<li>
<p>The MMU mappings for the BIMA and all IIOs shall be such that the
TLBs can accommodate a reasonable number of additional mappings.</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Notes</div>
<div class="ulist">
<ul>
<li>
<p>A boot program might wish to select BIMA size based on client image layout in order to
satisfy requirement #2</p>
</li>
<li>
<p>Client can determine physical address of IMA by either of two methods:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>tlbsx on EA 0, then read and parse TLB entry</p>
</li>
<li>
<p>from the optional initial-mapped-area property on a memory node</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_symmetric_multiprocessing_smp_boot_requirements">5.5. Symmetric Multiprocessing (SMP) Boot Requirements</h3>
<div class="sect3">
<h4 id="_overview_2">5.5.1. Overview</h4>
<div class="paragraph">
<p>For CPUs in an SMP configuration, one CPU shall be designated the boot
CPU and initialized as described in section 5.4, CPU Entry Point
Requirements. All other CPUs are considered secondary.</p>
</div>
<div class="paragraph">
<p>A boot program passes control to a client program on the boot CPU only.
At the time the client program is started, all secondary CPUs shall in a
quiescent state. A quiescent CPU is in a state where it cannot interfere
with the normal operation of other CPUs, nor can its state be affected
by the normal operation of other running CPUs, except by an explicit
method for enabling or re-enabling the quiescent CPU. The status
property of the quiescent CPU&#8217;s cpu node in the device tree shall have a
value of “disabled” (see 3.7.1, General Properties of CPU nodes).</p>
</div>
<div class="paragraph">
<p>Secondary CPUs may be started using the spin table or
implementation-specific mechanisms described in the following sections.</p>
</div>
</div>
<div class="sect3">
<h4 id="_spin_table">5.5.2. Spin Table</h4>
<div class="sect4">
<h5 id="_overview_3">Overview</h5>
<div class="paragraph">
<p>The ePAPR defines a spin table mechanism for starting secondary CPUs.
The boot program places all secondary CPUs into a loop where each CPU
spins until the branch_address field in the spin table is updated
specifying that the core is released.</p>
</div>
<div class="paragraph">
<p>A spin table is a table data structure consisting of 1 entry per CPU
where each entry is defined as follows:</p>
</div>
<div class="verseblock">
<pre class="content">struct {
	uint64_t entry_addr;
	uint64_t r3;
	uint32_t rsvd1;
	uint32_t pir;
};</pre>
</div>
<div class="paragraph">
<p>The spin table fields are defined as follows:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
entry_addr
</td>
<td class="hdlist2">
<p>Specifies the physical address of the client entry point
for the spin table code to branch to. The boot program&#8217;s spin loop must
wait until the least significant bit of entry_addr is zero.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
r3
</td>
<td class="hdlist2">
<p>Contains the value to put in the r3 register at secondary cpu
entry. The high 32-bits are ignored on 32-bit chip implementations.
64-bit chip implementations however shall load all 64-bits</p>
</td>
</tr>
<tr>
<td class="hdlist1">
pir
</td>
<td class="hdlist2">
<p>Contains a value to load into the PIR (processor identification)
register for those CPUs with writable PIR.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before a secondary CPU enters a spin loop, the spin table fields shall
be set with these initial values:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Initial Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entry_addr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">r3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of the <em>reg</em> property from the CPU node in the device
tree that corresponds to this CPU.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A valid PIR value, different on each CPU within the same
partition.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The spin table shall be cache-line size aligned in memory.</p>
</div>
<div class="paragraph">
<p>The boot program and client program shall ensure that all virtual pages
through which the spin table can be accessed have storage control
attributes such that all accesses to the spin table are not Write
Through Required, not Caching Inhibited, Memory Coherence Required, and
either not Guarded or Guarded (i.e., WIMG = 0b001x). Further, if the E
storage attribute is supported, it shall be set to BigEndian (E = 0),
and if the VLE storage attribute is supported, it shall be set to 0.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Note</div>
<div class="paragraph">
<p>Some older boot programs perform Caching Inhibited and not Memory
Coherence Required accesses to the spin table, taking advantage of
implementation-specific knowledge of the behavior of accesses to shared
storage with conflicting Caching Inhibited attribute values. If
compatibility with such boot programs is required, client programs
should use dcbf to flush a spin table entry from the caches both before
and after accessing the spin table entry.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_boot_program_requirements_2">Boot Program Requirements</h5>
<div class="paragraph">
<p>The boot program shall place a spin loop and spin table into an area of
memory that is appropriate for the platform. If the spin loop and table
reside in a memory region belonging to a client program, the memory
occupied by the loop and table shall be marked reserved in the device
tree&#8217;s DTB memory reservation block (see section 8.3, Memory Reservation
Block).</p>
</div>
<div class="paragraph">
<p>Before starting a client program on the boot cpu, the boot program shall
set certain properties in the device tree passed to the client as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each secondary CPU&#8217;s cpu node shall have a status property with a
value of “disabled”.</p>
</li>
<li>
<p>Each secondary CPU&#8217;s cpu node shall have an enable-method property.</p>
</li>
<li>
<p>For each secondary cpu node with an enable-method value of
“spin-table”, the cpu node shall have a cpu-release-addr property that
describes the address of the applicable spin table entry to release
the CPU.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For secondary CPUs with address translation always enabled (e.g., Book
III-E), the boot program shall set up an address mapping in the
secondary CPU&#8217;s MMU for the spin loop and table.</p>
</div>
<div class="paragraph">
<p>The boot program shall place a spinning CPU in a quiescent state where
it cannot interfere with the normal operation of other CPUs, nor can its
state be affected by the normal operation of other running CPUs, except
by an explicit method for enabling or reenabling the quiescent CPU. (see
the enable-method property). Note in particular that a running CPU shall
be able to issue broadcast TLB invalidations without affecting a
quiescent CPU.</p>
</div>
<div class="paragraph">
<p>When a secondary CPU is released from its spin loop, its state shall be
identical to the state of boot CPUs (see 5.4.1, Boot CPU Initial
Register State) except as noted here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>R3 contains the value of the r3 field from the spin table (only for
the first thread of the CPU).</p>
</li>
<li>
<p>R6 shall be 0.</p>
</li>
<li>
<p>If the CPU has a programmable PIR register, the PIR shall contain the
value of the pir field from the spin table.</p>
</li>
<li>
<p>No I/O device mappings (see 5.4.3, Initial I/O Mappings (IIO)) are
required.</p>
</li>
<li>
<p>For CPUs with address translation always enabled:</p>
<div class="ulist">
<ul>
<li>
<p>The Secondary IMA (SIMA) mapping (described in 5.3, Initial Mapped
Areas) in the MMU shall map effective address 0 to the entry_addr
field in the spin table, aligned down to the SIMA size.</p>
</li>
<li>
<p>R7 shall contain the size of the SIMA.</p>
</li>
<li>
<p>The SIMA shall have a minimum size of 1MiB.</p>
</li>
<li>
<p>Other mappings may be present in Address Space (AS) 0.</p>
</li>
<li>
<p>No mappings shall be present in Address Space (AS) 1.</p>
</li>
<li>
<p>The MMU mapping for the SIMA shall be such that the TLBs can
accommodate a reasonable number of additional mappings.</p>
</li>
<li>
<p>The SIMA mapping shall not be affected by any actions taken by any
other CPU.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For real mode (i.e., non-Book III-E) CPUs:</p>
<div class="ulist">
<ul>
<li>
<p>The CPU shall have address translation disabled at client entry
(i.e., (MSR[IR] =0, MSR[DR]=0).</p>
</li>
<li>
<p>R7 shall contain the size of the contiguous physical memory available
to the client.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: Spin table entries do not need to lie in either the BIMA or SIMA.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Notes</div>
<div class="ulist">
<ul>
<li>
<p>A client program should physically align its secondary entry points so
that the 1MiB SIMA size requirement is sufficient to ensure that
enough code is in the SIMA to transfer the secondary CPU to the
client&#8217;s MMU domain (which will typically involve a temporary mapping
in AS1)</p>
</li>
<li>
<p>Boot programs will typically need to establish the SIMA mapping after
leaving the spin loop and reading the entry_addr spin table field.
However, this mapping might not be necessary if, for example, the boot
program always uses a SIMA that covers all RAM.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_program_requirements_2">Client Program Requirements</h5>
<div class="paragraph">
<p>When a client program is started on its boot CPU, it is passed a device
tree that specifies all secondary CPUs that belong to the client, the
state of those CPUs, and the address of the spin table entry to release
each CPU.</p>
</div>
<div class="paragraph">
<p>For each secondary CPU, the physical address of the spin table entry for
the CPU is specified in the device tree in the cpu node&#8217;s
cpu-release-addr property. To activate a secondary CPU, the client
program (running on the boot cpu) may write the pir field value, may
write the r3 value, may write the most significant 32 bits of the
entry_addr value, and shall write the least significant 32 bits of the
entry_addr value. After the client has written the least significant 32
bits of the entry_addr field, the entry_addr field might subsequently be
altered by the boot program.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Note</div>
<div class="paragraph">
<p>The client program may use a 64-bit store instruction to write both the
most significant 32 bits and the least significant 32 bits of the
entry_addr field atomically. However, since the client program is
permitted to use two 32-bit store instructions to write the entry_addr
field (the first store for the most significant 32 bits and the second
store for the least significant 32 bits), the boot program&#8217;s spin loop
must wait until the least significant bit of entry_addr is zero (in
particular, it is insufficient for the boot program only to wait until
entry_addr has a value other than 0x1).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_implementation_specific_release_from_reset">5.5.3. Implementation-Specific Release from Reset</h4>
<div class="paragraph">
<p>Some CPUs have implementation-specific mechanisms to hold CPUs in reset
(or otherwise inhibit them from executing instructions) and can also
direct CPUs to arbitrary reset vectors.</p>
</div>
<div class="paragraph">
<p>The use of implementation-specific mechanisms is permitted by the ePAPR.
CPUs with this capability are indicated by an implementation-specific
value in the enable-method property of a CPU node. A client program can
release these types of CPUs using implementation-specific means not
specified by the ePAPR.</p>
</div>
</div>
<div class="sect3">
<h4 id="_timebase_synchronization">5.5.4. Timebase Synchronization</h4>
<div class="paragraph">
<p>For configurations that use the spin table method of booting secondary
cores (i.e.CPU&#8217;s enablemethod = “spin-table”), the boot program shall
enable and synchronize the time base (TBU and TBL) across the boot and
secondary CPUs.</p>
</div>
<div class="paragraph">
<p>For configurations that use implementation specific methods (see section
5.5.3) to release secondary cores, the methods must provide some means
of synchronizing the time base across CPUs. The precise means to
accomplish this, which steps are the responsibility of the boot program,
and which are the responsibility of the client program is specified by
the implementation specific method.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_asymmetric_configuration_considerations">5.6. Asymmetric Configuration Considerations</h3>
<div class="paragraph">
<p>For multiple CPUs in a partitioned or asymmetric (AMP) configuration,
the ePAPR boot requirements apply independently to each domain or
partition. For example, a four-CPU system could be partitioned into
three domains: one SMP domain with two CPUs and two UP domains each with
one CPU. Each domain could have distinct client image, device tree, boot
cpu, etc.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_device_bindings">6. Device Bindings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter contains requirements, known as bindings, for how specific
types and classes of devices are represented in the device tree. The
compatible property of a device node describes the specific binding (or
bindings) to which the node complies.</p>
</div>
<div class="paragraph">
<p>Bindings may be defined as extensions of other each. For example a new
bus type could be defined as an extension of the simple-bus binding. In
this case, the compatible property would contain several strings
identifying each binding—from the most specific to the most general (see
section 2.3.1, compatible).</p>
</div>
<div class="sect2">
<h3 id="_binding_guidelines">6.1. Binding Guidelines</h3>
<div class="sect3">
<h4 id="_general_principles">6.1.1. General Principles</h4>
<div class="paragraph">
<p>When creating a new device tree representation for a device, a binding
should be created that fully describes the required properties and value
of the device. This set of properties shall be sufficiently descriptive
to provide device drivers with needed attributes of the device.</p>
</div>
<div class="paragraph">
<p>Some recommended practices include:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define a compatible string using the conventions described in section 2.3.1.</p>
</li>
<li>
<p>Use the standard properties (defined in sections 2.3 and 2.4) as
applicable for the new device.  This usage typically includes the <em>reg</em>
and interrupts properties at a minimum.</p>
</li>
<li>
<p>Use the conventions specified in section 6 (Device Bindings) if the
new device fits into one the ePAPR defined device classes.</p>
</li>
<li>
<p>Use the miscellaneous property conventions specified in section
6.1.2, if applicable.</p>
</li>
<li>
<p>If new properties are needed by the binding, the recommended format
for property names is: “&lt;company&gt;,&lt;property-name&gt;”, where &lt;company&gt;
is an OUI or short unique string like a stock ticker that identifies
the creator of the binding.</p>
<div class="paragraph">
<p>Example: ibm,ppc-interrupt-server#s</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_miscellaneous_properties">6.1.2. Miscellaneous Properties</h4>
<div class="paragraph">
<p>This section defines a list of helpful properties that might be
applicable to many types of devices and device classes. They are defined
here to facilitate standardization of names and usage.</p>
</div>
<div class="sect4">
<h5 id="_clock_frequency">clock-frequency</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>clock-frequency</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;prop-encoded-array&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies the frequency of a clock in Hz. The value is a &lt;prop-encoded-array&gt; in one of two
forms:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a 32-bit integer consisting of one &lt;u32&gt; specifying the frequency</p>
</li>
<li>
<p>a 64-bit integer represented as a &lt;u64&gt; specifying the frequency</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_reg_shift">reg-shift</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>reg-shift</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;u32&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>The <em>reg-shift</em> property provides a mechanism to represent devices that
are identical in most respects except for the number of bytes between
registers. The <em>reg-shift</em> property specifies in bytes how far the
discrete device registers are separated from each other. The individual
register location is calculated by using following formula: “registers
address” &lt;&lt; reg-shift. If unspecified, the default value is 0.</p>
<div class="paragraph">
<p>For example, in a system where 16540 UART registers are located at
addresses 0x0, 0x4, 0x8, 0xC, 0x10, 0x14, 0x18, and 0x1C, a <code>reg-shift =
&lt;2&gt;</code> property would be used to specify register locations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_label">label</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>label</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;string&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>The label property defines a human readable string describing a device.
The binding for a given device specifies the exact meaning of the
property for that device.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_serial_devices">6.2. Serial devices</h3>
<div class="sect3">
<h4 id="_serial_class_binding">6.2.1. Serial Class Binding</h4>
<div class="paragraph">
<p>The class of serial devices consists of various types of point to point
serial line devices. Examples of serial line devices include the 8250
UART, 16550 UART, HDLC device, and BISYNC device. In most cases hardware
compatible with the RS-232 standard fit into the serial device class.</p>
</div>
<div class="paragraph">
<p>I<sup>2</sup>C and SPI (Serial Peripheral Interface) devices shall not be
represented as serial port devices because they have their own specific
representation.</p>
</div>
<div class="sect4">
<h5 id="_clock_frequency_2">clock-frequency</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>clock-frequency</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;u32&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies the frequency in Hertz of the baud rate generator&#8217;s input
clock.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
<p>clock-frequency = &lt;100000000&gt;;</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_current_speed">current-speed</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>current-speed</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;u32&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies the current speed of a serial device in bits per second. A
boot program should set this property if it has initialized the serial
device.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
<p>current-speed = &lt;115200&gt;; # 115200 baud</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_national_semiconductor_16450_16550_compatible_uart_requirements">6.2.2. National Semiconductor 16450/16550 Compatible UART Requirements</h4>
<div class="paragraph">
<p>Serial devices compatible to the National Semiconductor 16450/16550 UART
(Universal Asynchronous Receiver Transmitter) should be represented in
the device tree using following properties.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 16. Table 6-1 ns16550 properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;stringlist&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value shall include “ns16550”.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">clock-frequency</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the frequency (in Hz) of the baud rate generator&#8217;s input clock</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">current-speed</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">OR</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies current serial device speed in bits per second</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reg</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;prop-encoded-array&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the physical address of the registers device within the
address space of the parent bus</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">interrupts</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">OR</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;prop-encoded-array&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the interrupts generated by this device. The value of the
interrupts property consists of one or more interrupt specifiers. The
format of an interrupt specifier is defined by the binding document
describing the node&#8217;s interrupt parent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reg-shift</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">O</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies in bytes how far the discrete device registers are separated
from each other. The individual register location is calculated by using
following formula: “registers address” &lt;&lt; reg-shift. If unspecified,
the default value is 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">virtual-reg</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt; or &lt;u64&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See section 2.3.7. Specifies an effective address that maps to the first
physical address specified in the <em>reg</em> property. This property is
required if this device node is the system&#8217;s console.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_network_devices">6.3. Network devices</h3>
<div class="paragraph">
<p>Network devices are packet oriented communication devices. Devices in
this class are assumed to implement the data link layer (layer 2) of the
seven-layer OSI model and use Media Access Control (MAC) addresses.
Examples of network devices include Ethernet, FDDI, 802.11, and
Token-Ring.</p>
</div>
<div class="sect3">
<h4 id="_network_class_binding">6.3.1. Network Class Binding</h4>
<div class="sect4">
<h5 id="_address_bits">address-bits</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>address-bits</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;u32&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies number of address bits required to address the device
described by this node. This property specifies number of bits in MAC
address. If unspecified, the default value is 48.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
<p>address-bits = &lt;48&gt;;</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_local_mac_address">local-mac-address</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>local-mac-address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;prop-encoded-array&gt; encoded as array of hex numbers</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies MAC address that was assigned to the network device described
by the node containing this property.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>local-mac-address = [ 00 00 12 34 56 78];</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_mac_address">mac-address</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>mac-address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;prop-encoded-array&gt; encoded as array of hex numbers</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies the MAC address that was last used by the boot program. This property should be
used in cases where the MAC address assigned to the device by the boot program is different
from the local-mac-address property. This property shall be used only if the value differs
from local-mac-address property value.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
<p>mac-address = [ 0x01 0x02 0x03 0x04 0x05 0x06 ];</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_max_frame_size">max-frame-size</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>max-frame-size</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;u32&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies maximum packet length in bytes that the physical interface can send and receive.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
<p>max-frame-size = &lt;1518&gt;;</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ethernet_specific_considerations">6.3.2. Ethernet specific considerations</h4>
<div class="paragraph">
<p>Network devices based on the IEEE 802.3 collections of LAN standards
(collectively referred to as Ethernet) may be represented in the device
tree using following properties, in addition to properties specified of
the network device class.</p>
</div>
<div class="paragraph">
<p>The properties listed in this section augment the properties listed in
the network device class.</p>
</div>
<div class="sect4">
<h5 id="_max_speed">max-speed</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>max-speed</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;u32&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies maximum speed (specified in megabits per second) supported the
device.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
<p>max-speed = &lt;1000&gt;;</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_phy_connection_type">phy-connection-type</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>phy-connection-type</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;string&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies interface type between the Ethernet device and a physical
layer (PHY) device. The value of this property is specific to the
implementation.</p>
<div class="paragraph">
<p>Recommended values are shown in the following table.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Connection type</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Media Independent Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mii</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reduced Media Independent Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rmii</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gigabit Media Independent Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rgmii</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reduced Gigabit Media Independent Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rgmii</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rgmii with internal delay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rgmii-id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rgmii with internal delay on TX only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rgmii-txid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rgmii with internal delay on RX only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rgmii-rxid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ten Bit Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tbi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reduced Ten Bit Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rtbi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serial Media Independent Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">smii</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>phy-connection-type = “mii”;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_phy_handle">phy-handle</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Property
</td>
<td class="hdlist2">
<p>phy-handle</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Value type
</td>
<td class="hdlist2">
<p>&lt;phandle&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Description
</td>
<td class="hdlist2">
<p>Specifies a reference to a node representing a physical layer (PHY)
device connected to this Ethernet device. This property is required in
case where the Ethernet device is connected a physical layer device.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Example
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>phy-handle = &lt;&amp;PHY0&gt;;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_open_pic_interrupt_controllers">6.4. open PIC Interrupt Controllers</h3>
<div class="paragraph">
<p>This section specifies the requirements for representing open PIC
compatible interrupt controllers. An open PIC interrupt controller
implements the open PIC architecture (developed jointly by AMD and
Cyrix) and specified in The Open Programmable Interrupt Controller (PIC)
Register Interface Specification Revision 1.2 <a href="#b18">[b18]</a>.</p>
</div>
<div class="paragraph">
<p>Interrupt specifiers in an open PIC interrupt domain are encoded with
two cells. The first cell defines the interrupt number. The second cell
defines the sense and level information.</p>
</div>
<div class="paragraph">
<p>Sense and level information shall be encoded as follows in interrupt
specifiers:</p>
</div>
<div class="verseblock">
<pre class="content">0 = low to high edge sensitive type enabled
1 = active low level sensitive type enabled
2 = active high level sensitive type enabled
3 = high to low edge sensitive type enabled</pre>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 17. Table 6-2 Open-pic properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value shall include “open-pic”.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reg</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;prop-encoded-array&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the physical address of the registers device within the
address space of the parent bus</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">interrupt-controller</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;empty&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies that this node is an interrupt controller</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#interrupt-cells</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shall be 2.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#address-cells</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;u32&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shall be 0.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
</div>
<div class="sect2">
<h3 id="_simple_bus">6.5. simple-bus</h3>
<div class="paragraph">
<p>System-on-a-chip processors may have an internal I/O bus that cannot be
probed for devices. The devices on the bus can be accessed directly
without additional configuration required. This type of bus is
represented as a node with a compatible value of “simple-bus”.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 18. Table 6-3 Simple-bus properties</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-center valign-top">Usage</th>
<th class="tableblock halign-center valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;string&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value shall include "simple-bus".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ranges</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&lt;prop-encoded-array&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This property represents the mapping
between parent address to child address spaces (see section 2.3.8, ranges).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Usage legend: R=Required, O=Optional, OR=Optional but Recommended, SD=See Definition</p>
</div>
<div class="paragraph">
<p>Note: All other standard properties (section 2.3) are allowed but are optional.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flat_device_tree_physical_structure">7. Flat Device Tree Physical Structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An ePAPR boot program communicates the entire device tree to the client
program as a single, linear, pointerless data structure known as the
flattened device tree or device tree blob.</p>
</div>
<div class="paragraph">
<p>This data structure consists of a small header (see 8.2), followed by
three variable sized sections: the memory reservation block (see 8.3),
the structure block (see 8.4) and the strings block (see 8.5). These
should be present in the flattened device tree in that order.  Thus, the
device tree structure as a whole, when loaded into memory at address,
will resemble the diagram in Figure 8-1 (lower addresses are at the top
of the diagram).</p>
</div>
<div class="listingblock">
<div class="title">Figure 8-1 Device Tree Structure</div>
<div class="content">
<pre>FIXME
address

struct fdt_header
(free space)
memory reservation block
(free space)
structure block

(free space)
strings block

(free space)

address + totalsize</pre>
</div>
</div>
<div class="paragraph">
<p>The (free space) sections may not be present, though in some cases they
might be required to satisfy the alignment constraints of the individual
blocks (see 8.6).</p>
</div>
<div class="sect2">
<h3 id="_versioning">7.1. Versioning</h3>
<div class="paragraph">
<p>Several versions of the flattened device tree structure have been
defined since the original definition of the format. Fields in the
header give the version, so that the client program can determine if the
device tree is encoded in a compatible format.</p>
</div>
<div class="paragraph">
<p>This document describes only version 17 of the format. ePAPR-compliant
boot programs shall provide a device tree of version 17 or later, and
should provide a device tree of a version that is backwards compatible
with version 16. ePAPR-compliant client programs shall accept device
trees of any version backwards compatible with version 17 and may accept
other versions as well.</p>
</div>
<div class="paragraph">
<p>Note: The version is with respect to the binary structure of the device
tree, not its content.</p>
</div>
</div>
<div class="sect2">
<h3 id="_header">7.2. Header</h3>
<div class="paragraph">
<p>The layout of the header for the device tree is defined by the following C structure. All the header
fields are 32-bit integers, stored in big-endian format.</p>
</div>
<div class="listingblock">
<div class="title">Flattened Device Tree Header Fields</div>
<div class="content">
<pre>	struct fdt_header {
		uint32_t magic;
		uint32_t totalsize;
		uint32_t off_dt_struct;
		uint32_t off_dt_strings;
		uint32_t off_mem_rsvmap;
		uint32_t version;
		uint32_t last_comp_version;
		uint32_t boot_cpuid_phys;
		uint32_t size_dt_strings;
		uint32_t size_dt_struct;
	};</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">magic</dt>
<dd>
<p>This field shall contain the value 0xd00dfeed (big-endian).</p>
</dd>
<dt class="hdlist1">totalsize</dt>
<dd>
<p>This field shall contain the total size of the device tree
data structure. This size shall encompass all sections of the structure:
the header, the memory reservation block, structure block and strings
block, as well as any free space gaps between the blocks or after the
final block.</p>
</dd>
<dt class="hdlist1">off_dt_struct</dt>
<dd>
<p>This field shall contain the offset in bytes of the
structure block (see 8.4) from the beginning of the header.</p>
</dd>
<dt class="hdlist1">off_dt_strings</dt>
<dd>
<p>This field shall contain the offset in bytes of the
strings block (see 8.5) from the beginning of the header.</p>
</dd>
<dt class="hdlist1">off_mem_rsvmap</dt>
<dd>
<p>This field shall contain the offset in bytes of the
memory reservation block (see 8.3) from the beginning of the header.</p>
</dd>
<dt class="hdlist1">version</dt>
<dd>
<p>This field shall contain the version of the device tree data
structure. The version is 17 if using the structure as defined in this
document. An ePAPR boot program may provide the device tree of a later
version, in which case this field shall contain the version number
defined in whichever later document gives the details of that version.</p>
</dd>
<dt class="hdlist1">last_comp_version</dt>
<dd>
<p>This field shall contain the lowest version of the
device tree data structure with which the version used is backwards
compatible. So, for the structure as defined in this document (version
17), this field shall contain 16 because version 17 is backwards
compatible with version 16, but not earlier versions. As per 8.1, an
ePAPR boot program should provide a device tree in a format which is
backwards compatible with version 16, and thus this field shall always
contain 16.</p>
</dd>
<dt class="hdlist1">boot_cpuid_phys</dt>
<dd>
<p>This field shall contain the physical ID of the
system&#8217;s boot CPU. It shall be identical to the physical ID given in the
<em>reg</em> property of that CPU node within the device tree.</p>
</dd>
<dt class="hdlist1">size_dt_strings</dt>
<dd>
<p>This field shall contain the length in bytes of the
strings block section of the device tree blob.</p>
</dd>
<dt class="hdlist1">size_dt_struct</dt>
<dd>
<p>This field shall contain the length in bytes of the
structure block section of the device tree blob.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_memory_reservation_block">7.3. Memory Reservation Block</h3>
<div class="sect3">
<h4 id="_purpose">7.3.1. Purpose</h4>
<div class="paragraph">
<p>The <em>memory reservation block</em> provides the client program with a list
of areas in physical memory which are <em>reserved</em>; that is, which shall
not be used for general memory allocations. It is used to protect vital
data structures from being overwritten by the client program. For
example, on some systems with an IOMMU, the TCE (translation control
entry) tables initialized by an ePAPR boot program would need to be
protected in this manner. Likewise, any boot program code or data used
during the client program&#8217;s runtime would need to be reserved (e.g.,
RTAS on Open Firmware platforms). The ePAPR does not require the boot
program to provide any such runtime components, but it does not prohibit
implementations from doing so as an extension.</p>
</div>
<div class="paragraph">
<p>More specifically, a client program shall not access memory in a
reserved region unless other information provided by the boot program
explicitly indicates that it shall do so. The client program may then
access the indicated section of the reserved memory in the indicated
manner. Methods by which the boot program can indicate to the client
program specific uses for reserved memory may appear in this document,
in optional extensions to it, or in platform-specific documentation.</p>
</div>
<div class="paragraph">
<p>The reserved regions supplied by a boot program may, but are not
required to, encompass the device tree blob itself. The client program
shall ensure that it does not overwrite this data structure before it is
used, whether or not it is in the reserved areas.</p>
</div>
<div class="paragraph">
<p>Any memory that is declared in a memory node and is accessed by the boot
program or caused to be accessed by the boot program after client entry
must be reserved. Examples of this type of access include (e.g.,
speculative memory reads through a non-guarded virtual page).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Note</div>
<div class="paragraph">
<p>This requirement is necessary because any memory that is not reserved
may be accessed by the client program with arbitrary storage attributes.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Any accesses to reserved memory by or caused by the boot program must be
done as not Caching Inhibited and Memory Coherence Required (i.e., WIMG
= 0bx01x), and additionally for Book III-S implementations as not Write
Through Required (i.e., WIMG = 0b001x). Further, if the VLE storage
attribute is supported, all accesses to reserved memory must be done as
VLE=0.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Programming Note</div>
<div class="paragraph">
<p>This requirement is necessary because the client program is permitted to
map memory with storage attributes specified as not Write Through
Required, not Caching Inhibited, and Memory Coherence Required (i.e.,
WIMG = 0b001x), and VLE=0 where supported. The client program may use
large virtual pages that contain reserved memory. However, the client
program may not modify reserved memory, so the boot program may perform
accesses to reserved memory as Write Through Required where conflicting
values for this storage attribute are architecturally permissible.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_format">7.3.2. Format</h4>
<div class="paragraph">
<p>The memory reservation block consists of a list of pairs of 64-bit
big-endian integers, each pair being represented by the following C
structure.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Memory Reservation Table Format</div>
<div class="content">
<div class="literalblock">
<div class="content">
<pre>struct fdt_reserve_entry {
    uint64_t address;
    uint64_t size;
};</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Each pair gives the physical address and size of a reserved memory
region. These given regions shall not overlap each other. The list of
reserved blocks shall be terminated with an entry where both address and
size are equal to 0. Note that the address and size values are always
64-bit. On 32-bit CPUs the upper 32-bits of the value are ignored.</p>
</div>
<div class="paragraph">
<p>Each uint64_t in the memory reservation block, and thus the memory
reservation block as a whole, shall be located at an 8-byte aligned
offset from the beginning of the device tree blob (see 8.6)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_structure_block">7.4. Structure Block</h3>
<div class="paragraph">
<p>The structure block describes the structure and contents of the device
tree itself. It is composed of a sequence of tokens with data, as
described in 0. These are organized into a linear tree structure, as
described in 0.</p>
</div>
<div class="paragraph">
<p>Each token in the structure block, and thus the structure block itself,
shall be located at a 4-byte aligned offset from the beginning of the
device tree blob (see 8.6).</p>
</div>
<div class="sect3">
<h4 id="_lexical_structure">7.4.1. Lexical structure</h4>
<div class="paragraph">
<p>The structure block is composed of a sequence of pieces, each beginning
with a token, that is, a bigendian 32-bit integer. Some tokens are
followed by extra data, the format of which is determined by the token
value. All tokens shall be aligned on a 32-bit boundary, which may
require padding bytes (with a value of 0x0) to be inserted after the
previous token&#8217;s data.</p>
</div>
<div class="paragraph">
<p>The five token types are as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">FDT_BEGIN_NODE (0x00000001)</dt>
<dd>
<p>The FDT_BEGIN_NODE token marks the beginning of a node&#8217;s representation.
It shall be followed by the node&#8217;s unit name as extra data. The name is
stored as a null-terminated string, and shall include the unit address
(see 2.2.1, Node Names), if any.  The node name is followed by zeroed
padding bytes, if necessary for alignment, and then the next token,
which may be any token except FDT_END.</p>
</dd>
<dt class="hdlist1">FDT_END_NODE (0x00000002)</dt>
<dd>
<p>The FDT_END_NODE token marks the end of a node&#8217;s representation. This
token has no extra data; so it is followed immediately by the next
token, which may be any token except FDT_PROP.</p>
</dd>
<dt class="hdlist1">FDT_PROP (0x00000003)</dt>
<dd>
<p>The FDT_PROP token marks the beginning of the representation of one
property in the device tree. It shall be followed by extra data
describing the property. This data consists first of the property&#8217;s
length and name represented as the following C structure:</p>
</dd>
</dl>
</div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>struct {
    uint32_t len;
    uint32_t nameoff;
}</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Both the fields in this structure are 32-bit big-endian integers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>len gives the length of the property&#8217;s value in bytes (which may be
zero, indicating an empty property, see 2.2.4.2, Property Values).</p>
</li>
<li>
<p>nameoff gives an offset into the strings block (see 8.5) at which the
property&#8217;s name is stored as a null-terminated string.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After this structure, the property&#8217;s value is given as a byte string of
length len. This value is followed by zeroed padding bytes (if
necessary) to align to the next 32-bit boundary and then the next token,
which may be any token except FDT_END.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">FDT_NOP (0x00000004)</dt>
<dd>
<p>The FDT_NOP token will be ignored by any program parsing the device
tree. This token has no extra data; so it is followed immediately by the
next token, which can be any valid token.  A property or node definition
in the tree can be overwritten with FDT_NOP tokens to remove it from the
tree without needing to move other sections of the tree&#8217;s representation
in the device tree blob.</p>
</dd>
<dt class="hdlist1">FDT_END (0x00000009)</dt>
<dd>
<p>The FDT_END token marks the end of the structure block. There shall be
only one FDT_END token, and it shall be the last token in the structure
block. It has no extra data; so the byte immediately after the FDT_END
token has offset from the beginning of the structure block equal to the
value of the size_dt_struct field in the device tree blob header.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_tree_structure">7.4.2. Tree structure</h4>
<div class="paragraph">
<p>The device tree structure is represented as a linear tree: the
representation of each node begins with an FDT_BEGIN_NODE token and ends
with an FDT_END_NODE token. The node&#8217;s properties and subnodes (if any)
are represented before the FDT_END_NODE, so that the FDT_BEGIN_NODE and
FDT_END_NODE tokens for those subnodes are nested within those of the
parent.</p>
</div>
<div class="paragraph">
<p>The structure block as a whole consists of the root node&#8217;s
representation (which contains the representations for all other nodes),
followed by an FDT_END token to mark the end of the structure block as a
whole.</p>
</div>
<div class="paragraph">
<p>More precisely, each node&#8217;s representation consists of the following
components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(optionally) any number of FDT_NOP tokens</p>
</li>
<li>
<p>FDT_BEGIN_NODE token</p>
<div class="ulist">
<ul>
<li>
<p>The node&#8217;s name as a null-terminated string</p>
</li>
<li>
<p>[zeroed padding bytes to align to a 4-byte boundary]</p>
</li>
</ul>
</div>
</li>
<li>
<p>For each property of the node:</p>
<div class="ulist">
<ul>
<li>
<p>(optionally) any number of FDT_NOP tokens</p>
</li>
<li>
<p>FDT_PROP token</p>
<div class="ulist">
<ul>
<li>
<p>property information as given in 8.4.1</p>
</li>
<li>
<p>[zeroed padding bytes to align to a 4-byte boundary]</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Representations of all child nodes in this format</p>
</li>
<li>
<p>(optionally) any number of FDT_NOP tokens</p>
</li>
<li>
<p>FDT_END_NODE token</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that this process requires that all property definitions for a
particular node precede any subnode definitions for that node. Although
the structure would not be ambiguous if properties and subnodes were
intermingled, the code needed to process a flat tree is simplified by
this requirement.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_strings_block">7.5. Strings Block</h3>
<div class="paragraph">
<p>The strings block contains strings representing all the property names
used in the tree. These nullterminated strings are simply concatenated
together in this section, and referred to from the structure block by an
offset into the strings block.</p>
</div>
<div class="paragraph">
<p>The strings block has no alignment constraints and may appear at any
offset from the beginning of the device tree blob.</p>
</div>
</div>
<div class="sect2">
<h3 id="_alignment">7.6. Alignment</h3>
<div class="paragraph">
<p>For the data in the memory reservation and structure blocks to be used
without unaligned memory accesses, they shall lie at suitably aligned
memory addresses. Specifically, the memory reservation block shall be
aligned to an 8-byte boundary and the structure block to a 4-byte
boundary.</p>
</div>
<div class="paragraph">
<p>Furthermore, the device tree blob as a whole can be relocated without
destroying the alignment of the subblocks.</p>
</div>
<div class="paragraph">
<p>As described in the previous sections, the structure and strings blocks
shall have aligned offsets from the beginning of the device tree blob.
To ensure the in-memory alignment of the blocks, it is sufficient to
ensure that the device tree as a whole is loaded at an address aligned
to the largest alignment of any of the subblocks, that is, to an 8-byte
boundary. As described in 5.2 (Device Tree) an ePAPRcompliant boot
program shall load the device tree blob at such an aligned address
before passing it to the client program. If an ePAPR client program
relocates the device tree blob in memory, it should only do so to
another 8-byte aligned address.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_a_device_tree_source_format_version_1">8. Appendix A Device Tree Source Format (version 1)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Device Tree Source (DTS) format is a textual representation of a device
tree in a form that can be processed by dtc into a binary device tree in the
form expected by the kernel. The following description is not a formal syntax
definition of DTS, but describes the basic constructs used to represent device
trees.</p>
</div>
<div class="sect2">
<h3 id="_node_and_property_definitions">8.1. Node and property definitions</h3>
<div class="paragraph">
<p>Device tree nodes are defined with a node name and unit address with braces
marking the start and end of the node definition. They may be preceded by a
label.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[label:] node-name[@unit-address] {
	[properties definitions]
	[child nodes]
}</pre>
</div>
</div>
<div class="paragraph">
<p>Nodes may contain property definitions and/or child node definitions. If both
are present, properties shall come before child nodes.</p>
</div>
<div class="paragraph">
<p>Property definitions are name value pairs in the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>	[label:] property-name = value;</pre>
</div>
</div>
<div class="paragraph">
<p>except for properties with empty (zero length) value which have the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>	[label:] property-name;</pre>
</div>
</div>
<div class="paragraph">
<p>Property values may be defined as an array of 32-bit integer cells, as
null-terminated strings, as bytestrings or a combination of these.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Arrays of cells are represented by angle brackets surrounding a space
separated list of C-style integers. Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>	interrupts = &lt;17 0xc&gt;;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A 64-bit value is represented with two 32-bit cells. Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>	clock-frequency = &lt;0x00000001 0x00000000&gt;;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A null-terminated string value is represented using double quotes (the property
value is considered to include the terminating NULL character). Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>	compatible = "simple-bus";</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A bytestring is enclosed in square brackets [ ] with each byte represented by
two hexadecimal digits. Spaces between each byte are optional. Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>	local-mac-address = [00 00 12 34 56 78];</pre>
</div>
</div>
<div class="paragraph">
<p>or equivalently:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>	local-mac-address = [000012345678];</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Values may have several comma-separated components, which are concatenated
together.  Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>	compatible = "ns16550", "ns8250";
	example = &lt;0xf00f0000 19&gt;, "a strange property format";</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In a cell array a reference to another node will be expanded to that node&#8217;s
phandle.  References may be &amp; followed by a node&#8217;s label. Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>	interrupt-parent = &lt; &amp;mpic &gt;;</pre>
</div>
</div>
<div class="paragraph">
<p>or they may be &amp; followed by a node&#8217;s full path in braces. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>	interrupt-parent = &lt; &amp;{/soc/interrupt-controller@40000} &gt;;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Outside a cell array, a reference to another node will be expanded to that
node&#8217;s full path.  Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>	ethernet0 = &amp;EMAC0;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Labels may also appear before or after any component of a property value, or
between cells of a cell array, or between bytes of a bytestring. Examples:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>	reg = reglabel: &lt;0 sizelabel: 0x1000000&gt;;
	prop = [ab cd ef byte4: 00 ff fe];
	str = start: "string value" end: ;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_file_layout">8.2. File layout</h3>
<div class="listingblock">
<div class="title">Version 1 DTS files have the overall layout:</div>
<div class="content">
<pre>/dts-v1/;
[memory reservations]
	/ {
		[property definitions]
		[child nodes]
	};</pre>
</div>
</div>
<div class="paragraph">
<p>The /dts-v1/; shall be present to identify the file as a version 1 DTS (dts
files without this tag will be treated by dtc as being in the obsolete version
0, which uses a different format for integers in addition to other small but
incompatible changes).</p>
</div>
<div class="paragraph">
<p>Memory reservations define an entry for the device tree blob&#8217;s memory
reservation table.  They have the form: e.g., /memreserve/ &lt;address&gt; &lt;length&gt;;
Where &lt;address&gt; and &lt;length&gt; are 64-bit C-style integers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The / { &#8230;&#8203; }; section defines the root node of the device tree.</p>
</li>
<li>
<p>C style (/* &#8230;&#8203; */) and C++ style (// &#8230;&#8203;) comments are supported.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.1<br>
Last updated 2016-04-05 02:05:28 BST
</div>
</div>
</body>
</html>